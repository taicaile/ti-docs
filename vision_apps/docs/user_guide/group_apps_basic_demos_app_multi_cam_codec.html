<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>Vision Apps User Guide: Multi Camera + Codec Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vision Apps User Guide
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group_apps_basic_demos_app_multi_cam_codec.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Multi Camera + Codec Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md51">Introduction</a></li>
<li class="level1"><a href="#autotoc_md52">Supported plaforms</a><ul><li class="level2"><a href="#autotoc_md53">LINUX</a></li>
<li class="level2"><a href="#autotoc_md54">QNX</a></li>
<li class="level2"><a href="#autotoc_md55">LINUX</a></li>
<li class="level2"><a href="#autotoc_md56">QNX</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md57">Data flow (RAW12 input)</a></li>
<li class="level1"><a href="#autotoc_md58">Steps to run the application on J7 EVM (Linux + RTOS mode)</a></li>
<li class="level1"><a href="#autotoc_md59">Steps to run the application on J7 EVM (QNX + RTOS mode)</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md51"></a>
Introduction</h1>
<p>This application demonstrates the use of Hardware Codec along with Capture and Display in multichannel mode. This is an extension of the <a class="el" href="group_apps_basic_demos_app_multi_cam.html">Multi Camera VPAC Application</a> with added codec functionality.</p>
<p>The application supports 3 modes of operation:</p>
<ol type="1">
<li>Capture + Encode : en_encode = 1, en_decode = 0<ol type="a">
<li>Captures video from IMX390 cameras</li>
<li>Encodes the video using Hardware H264 encoder</li>
<li>Writes the output as a video file</li>
</ol>
</li>
<li>Decode + Display : en_encode = 0, en_decode = 1<ol type="a">
<li>Reads a H264 encoded Video file</li>
<li>Decodes the video stream using Hardware H264 decoder</li>
<li>Displays the output after mosaic</li>
</ol>
</li>
<li>Capture + Encode + Decode + Display (Default) : en_encode = 1, en_decode = 1<ol type="a">
<li>Captures video from IMX390 cameras</li>
<li>Encodes the video using Hardware H264 encoder</li>
<li>Decodes the video stream using Hardware H264 decoder</li>
<li>Displays the output after mosaic</li>
</ol>
</li>
</ol>
<p>The application assumes that all cameras are identical. Any number of channels from 1-4 can be selected by the user, subject to constraints of sensor and codec drivers.</p>
<h1><a class="anchor" id="autotoc_md52"></a>
Supported plaforms</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform  </th><th class="markdownTableHeadNone">Linux x86_64  </th><th class="markdownTableHeadNone">Linux+RTOS mode  </th><th class="markdownTableHeadNone">QNX+RTOS mode  </th><th class="markdownTableHeadNone">SoC   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Capture+Encode Only)  </td><td class="markdownTableBodyNone">J721E   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Decode+Display Only)  </td><td class="markdownTableBodyNone">J721E   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Capture+Encode Only)  </td><td class="markdownTableBodyNone">J721S2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Decode+Display Only)  </td><td class="markdownTableBodyNone">J721S2   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Capture+Encode Only)  </td><td class="markdownTableBodyNone">J784S4   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES (Decode+Display Only)  </td><td class="markdownTableBodyNone">J784S4   </td></tr>
</table>
<p><b>Note on expected performance:</b></p>
<p>Due to limitations of the Codec (Hardware or driver), the demo may not hit 30FPS for 4 channels of 1080p resolution. Following table lists the expected performance of the codec across devices</p>
<h2><a class="anchor" id="autotoc_md53"></a>
LINUX</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode / SOC  </th><th class="markdownTableHeadNone">J721E  </th><th class="markdownTableHeadNone">J721S2  </th><th class="markdownTableHeadNone">J784S4   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Encode  </td><td class="markdownTableBodyNone">2x1080p20  </td><td class="markdownTableBodyNone">4x1080p30  </td><td class="markdownTableBodyNone">4x1080p30   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Decode  </td><td class="markdownTableBodyNone">4x1080p30  </td><td class="markdownTableBodyNone">4x1080p30  </td><td class="markdownTableBodyNone">4x1080p30   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md54"></a>
QNX</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode / SOC  </th><th class="markdownTableHeadNone">J721E  </th><th class="markdownTableHeadNone">J721S2  </th><th class="markdownTableHeadNone">J784S4   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Encode  </td><td class="markdownTableBodyNone">2x1080p12  </td><td class="markdownTableBodyNone">4x1080p18  </td><td class="markdownTableBodyNone">4x1080p30   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Decode  </td><td class="markdownTableBodyNone">2x1080p3  </td><td class="markdownTableBodyNone">4x1080p13  </td><td class="markdownTableBodyNone">4x1080p30   </td></tr>
</table>
<p><b>Note on CMA size requirements:</b></p>
<p>The Codec in J721S2/J784S4 requires CMA memory allocation, and due to memory constraints the application may fail for higher number of channels. Following is the table showing out of box support for these devices:</p>
<h2><a class="anchor" id="autotoc_md55"></a>
LINUX</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode / SOC  </th><th class="markdownTableHeadNone">J721S2  </th><th class="markdownTableHeadNone">J784S4   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Encode  </td><td class="markdownTableBodyNone">4 channel  </td><td class="markdownTableBodyNone">4 channel   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Decode  </td><td class="markdownTableBodyNone">4 channel  </td><td class="markdownTableBodyNone">2 channel   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Enc + dec  </td><td class="markdownTableBodyNone">3 channel  </td><td class="markdownTableBodyNone">2 channel   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md56"></a>
QNX</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode / SOC  </th><th class="markdownTableHeadNone">J721S2  </th><th class="markdownTableHeadNone">J784S4   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Encode  </td><td class="markdownTableBodyNone">4 channel  </td><td class="markdownTableBodyNone">4 channel   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Decode  </td><td class="markdownTableBodyNone">4 channel  </td><td class="markdownTableBodyNone">4 channel   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md57"></a>
Data flow (RAW12 input)</h1>
<div class="image">
<img src="app_multi_cam_codec_data_flow.png" alt="app_multi_cam_codec_data_flow.png"/>
</div>
<h1><a class="anchor" id="autotoc_md58"></a>
Steps to run the application on J7 EVM (Linux + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for Linux+RTOS mode</li>
<li>Build and install the edgeai components required to run the codec application. This is an additional step required only for the codec application. The steps can be found below: <div class="fragment"><div class="line">make edgeai</div><div class="line">make linux_fs_install_sd</div></div><!-- fragment --></li>
<li>Connect four D3-IMX390 RCM sensor boards on cam0, cam1, cam2 and cam3 input ports of the Fusion1 board.</li>
<li>Use the is_interactive flag to run the demo in an interactive mode which allows the user to print performance characteristics on the UART console.</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /opt/vision_apps</div><div class="line">source ./vision_apps_init.sh</div><div class="line">./run_app_multi_cam_codec.sh</div></div><!-- fragment --></li>
<li>Depending on the mode of operation, the processed output for each of the captured channels is either displayed through DSS on display or written to a H264 encoded video file (.mp4).</li>
</ol>
<h1><a class="anchor" id="autotoc_md59"></a>
Steps to run the application on J7 EVM (QNX + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for QNX+RTOS mode</li>
<li>Connect four D3-IMX390 RCM sensor boards on cam0, cam1, cam2 and cam3 input ports of the Fusion1 board.</li>
<li>Use the is_interactive flag to run the demo in an interactive mode which allows the user to print performance characteristics on the UART console.</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /ti_fs/vision_apps</div><div class="line">./vision_apps_init.sh</div><div class="line">./run_app_multi_cam_codec.sh</div></div><!-- fragment --></li>
<li>Depending on the mode of operation, the processed output for each of the captured channels is either displayed through DSS on display or written to a H264 encoded video file (.264). </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
