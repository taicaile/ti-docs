<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>Vision Apps User Guide: 3D Surround View Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vision Apps User Guide
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group_apps_srv_demos_app_srv_camera.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">3D Surround View Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md163">Introduction</a></li>
<li class="level1"><a href="#autotoc_md164">Supported plaforms</a></li>
<li class="level1"><a href="#autotoc_md165">Data flow</a></li>
<li class="level1"><a href="#autotoc_md166">Steps to run the application on J7 EVM</a></li>
<li class="level1"><a href="#autotoc_md167">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md163"></a>
Introduction</h1>
<p>This application shows a 4 image sensor 3D Surround View image. The 4 cameras capture a raw image which is processed by the on-chip ISP. The 4 images are given to the GPU to do the 3D Surround View rendering. This image is given to the DSS to display on a screen. Important note: it is requires to first run the vx_app_srv_calibration prior to running 3D SRV in order to have a properly calibrated image.</p>
<h1><a class="anchor" id="autotoc_md164"></a>
Supported plaforms</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform  </th><th class="markdownTableHeadNone">Linux x86_64  </th><th class="markdownTableHeadNone">Linux+RTOS mode  </th><th class="markdownTableHeadNone">QNX+RTOS mode  </th><th class="markdownTableHeadNone">SoC   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">J721e / J721S2 / J784S4   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md165"></a>
Data flow</h1>
<p>The Surround View app contains two separate graphs. The first graph is simply used for generating the GPU LUT that contains the SRV bowl mapping. This graph is only executed once with the given application; however, if the GPU LUT needs to change depending on the scene, this can be run multiple times. The second graph contains the full GPU SRV, capturing using the capture node, giving the raw output to the VISS and AEWB nodes to perform the image processing. The output of the VISS is then given to the GPU to perform the rendering of the SRV image. Finally, this output image is given to the display node to be shown on the screen.</p>
<div class="image">
<img src="vx_app_srv_camera_data_flow.png" alt="vx_app_srv_camera_data_flow.png"/>
</div>
<h1><a class="anchor" id="autotoc_md166"></a>
Steps to run the application on J7 EVM</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a></li>
<li>Follow steps 1-3 as mentioned in <a class="el" href="RUN_INSTRUCTIONS.html">Run Instructions</a><ol type="a">
<li>Important note: be sure to extract all test data to SD card or else the demo won't run</li>
</ol>
</li>
<li>The input files come from "${VX_TEST_DATA_PATH}/test_data/psdkra/srv/srv_app/"</li>
<li>In Linux+RTOS mode<ol type="a">
<li>Setup requirements:<ol type="i">
<li>Connect 4 D3-IMX390 (Version1-D3RCM) sensor boards on cam0-cam3 input port of the Fusion1 Platform, as shown in the above image. (Note: these are the only sensors that have been tested with the SRV demo). Please ensure that the power to the Fusion1 Platform is connected.</li>
<li>The four cameras must be connected in the order front, right, back, left to cam0, cam1, cam2, cam3 respectively.</li>
<li>Either an eDP display or HDMI display with infotainment daughter card must be connected to the EVM in order to visualize the Surround View output. Note: the display type is chosen via a build option as described in Step 3 of <a class="el" href="RUN_INSTRUCTIONS.html">Run Instructions</a></li>
</ol>
</li>
<li>Prior to running the SRV demo, the <a class="el" href="group_apps_srv_demos_app_srv_calibration.html">Surround View Calibration</a> demo must be run in order to view a properly calibrated demo.</li>
<li>After running the Surround View Calibration demo, the following files will be located in the "${VX_TEST_DATA_PATH}/test_data/psdkra/srv/srv_app/" path:<ol type="i">
<li>CALMAT.BIN</li>
<li>CHARTPOS.BIN</li>
<li>LENS.BIN</li>
</ol>
</li>
<li>You may need to power cycle the board after running the calibration demo. If the SRV demo hangs after running calibration, please power cycle the board.</li>
<li>The files "app_srv.cfg" and run_app_srv.sh will be copied from the folder "vision_apps/apps/basic_demos/app_linux_fs_files" to the /opt/vision_apps folder.</li>
<li>The values in "app_srv.cfg" can be modified as described below:<ol type="i">
<li>The is2MP value is not used in the camera-based demo so this can be ignored.</li>
<li>The offsetXleft, offsetXright, offsetYfront, and offsetYback correspond to the size of the Surround View bowl. The Surround View bowl is a 1080x1080 bowl and these numbers correspond to the distance from the center of this bowl. These can be adjusted to form a more narrow bowl if desired.</li>
<li>The num_views parameter as well as each view parameters can be adjusted as desired to modify the viewpoints seen in the demo. Note: the num_views and the total number of view parameters must match.</li>
</ol>
</li>
<li>VX_TEST_DATA_PATH environment variable is set as part of vision_apps_init.sh</li>
<li>Run the app as shown below on the EVM target <div class="fragment"><div class="line">cd /opt/vision_apps</div><div class="line">source ./vision_apps_init.sh</div><div class="line">./run_app_srv.sh</div></div><!-- fragment --></li>
<li>Output will be visualized in real-time on your screen</li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md167"></a>
Sample Output</h1>
<p>Shown below is a sample image of the output of the Surround View application</p>
<div class="image">
<img src="app_srv_output.jpg" alt="app_srv_output.jpg"/>
</div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
