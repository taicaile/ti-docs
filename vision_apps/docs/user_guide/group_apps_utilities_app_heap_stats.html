<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>Vision Apps User Guide: Remote Core Heap Statistics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vision Apps User Guide
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group_apps_utilities_app_heap_stats.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Remote Core Heap Statistics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md184">Introduction</a></li>
<li class="level1"><a href="#autotoc_md185">Background</a></li>
<li class="level1"><a href="#autotoc_md186">Supported plaforms</a></li>
<li class="level1"><a href="#autotoc_md187">Steps to run the application on J7 EVM (Linux + RTOS mode)</a></li>
<li class="level1"><a href="#autotoc_md188">Steps to run the application on J7 EVM (QNX + RTOS mode)</a></li>
<li class="level1"><a href="#autotoc_md189">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md184"></a>
Introduction</h1>
<p>This application queries remote services running on each of the remote RTOS cores and reports instantaneous memory utilization of the various memory regions for each remote core. This utility is helpful to see the remote core memory utilization required for running one or more applications on the HLOS.</p>
<p>It can also be used to quickly identify if running an application on the HLOS incurrs any memory leaks on a remote core. To do this, one simply needs run this utility before and after running an application, and then compare the printout between the two runs to see if memory utilization has changed.</p>
<h1><a class="anchor" id="autotoc_md185"></a>
Background</h1>
<p>Upon booting of different remote cores, some of the local memory sections are initialized and allocated according to the compiled programs running on each core (regardless of what is running on the HLOS). This is why if you run this utility after the HLOS finishes booting before running any other program, there is some of the remote core local memory regions already reserved.</p>
<p>Likewise, when an OpenVX graph is created and "validated", some of the node which run on the remote cores may require to reserve some persistent or scratch memory. This is taken from the pool of remote local carveout. If this memory runs out, then the OpenVX vxVerifyGraph() function will fail, which should prompt the developer to carve out larger memory carveouts for that specific remote core and recompile so that the application can run with sufficient memory. Upon deleting the graph, any memory reserved by associated nodes shall be freed, thus returning the memory allocation state to what it was before running creating the graph and running the application.</p>
<h1><a class="anchor" id="autotoc_md186"></a>
Supported plaforms</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform  </th><th class="markdownTableHeadNone">Linux x86_64  </th><th class="markdownTableHeadNone">Linux+RTOS mode  </th><th class="markdownTableHeadNone">QNX+RTOS mode  </th><th class="markdownTableHeadNone">SoC   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">J721e / J721S2 / J784S4   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md187"></a>
Steps to run the application on J7 EVM (Linux + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for Linux+RTOS mode</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /opt/vision_apps</div><div class="line">source ./vision_apps_init.sh</div><div class="line">./vx_app_heap_stats.out</div></div><!-- fragment --></li>
<li>Output will be sent to the terminal standard output.</li>
</ol>
<h1><a class="anchor" id="autotoc_md188"></a>
Steps to run the application on J7 EVM (QNX + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for QNX+RTOS mode</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /ti_fs/vision_apps</div><div class="line">. ./vision_apps_init.sh</div><div class="line">./vx_app_heap_stats.out</div></div><!-- fragment --></li>
<li>Output will be sent to the terminal standard output.</li>
</ol>
<h1><a class="anchor" id="autotoc_md189"></a>
Sample Output</h1>
<p>Shown below is a example output from running this utility:</p>
<div class="fragment"><div class="line">root@j721s2-evm:/opt/vision_apps# ./vx_app_heap_stats.out </div><div class="line">APP: Init ... !!!</div><div class="line">MEM: Init ... !!!</div><div class="line">MEM: Initialized DMA HEAP (fd=4) !!!</div><div class="line">MEM: Init ... Done !!!</div><div class="line">IPC: Init ... !!!</div><div class="line">IPC: Init ... Done !!!</div><div class="line">REMOTE_SERVICE: Init ... !!!</div><div class="line">REMOTE_SERVICE: Init ... Done !!!</div><div class="line">   359.259491 s: GTC Frequency = 200 MHz</div><div class="line">APP: Init ... Done !!!</div><div class="line"></div><div class="line">Detailed CPU memory statistics,</div><div class="line">===============================</div><div class="line"></div><div class="line">CPU: mcu2_0: HEAP:   DDR_SHARED_MEM: size =   16777216 B, free =   16773120 B ( 99 % unused)</div><div class="line"></div><div class="line">CPU: mcu2_1: HEAP:   DDR_SHARED_MEM: size =   16777216 B, free =   16773120 B ( 99 % unused)</div><div class="line"></div><div class="line">CPU:  c7x_1: HEAP:   DDR_SHARED_MEM: size =  268435456 B, free =  268435200 B ( 99 % unused)</div><div class="line">CPU:  c7x_1: HEAP:           L3_MEM: size =    3964928 B, free =    3964928 B (100 % unused)</div><div class="line">CPU:  c7x_1: HEAP:           L2_MEM: size =     458752 B, free =     458752 B (100 % unused)</div><div class="line">CPU:  c7x_1: HEAP:           L1_MEM: size =      16384 B, free =      16384 B (100 % unused)</div><div class="line">CPU:  c7x_1: HEAP:  DDR_SCRATCH_MEM: size =  419430400 B, free =  419430400 B (100 % unused)</div><div class="line"></div><div class="line">CPU:  c7x_2: HEAP:   DDR_SHARED_MEM: size =   16777216 B, free =   16776960 B ( 99 % unused)</div><div class="line">CPU:  c7x_2: HEAP:           L2_MEM: size =     458752 B, free =     458752 B (100 % unused)</div><div class="line">CPU:  c7x_2: HEAP:           L1_MEM: size =      16384 B, free =      16384 B (100 % unused)</div><div class="line">CPU:  c7x_2: HEAP:  DDR_SCRATCH_MEM: size =   67108864 B, free =   67108864 B (100 % unused)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Detailed CPU OS memory statistics,</div><div class="line">==================================</div><div class="line"></div><div class="line">CPU: mcu2_0</div><div class="line">  semaphore:  cnt=    123</div><div class="line">  mutex:      cnt=      0</div><div class="line">  queue:      cnt=      0</div><div class="line">  event:      cnt=      0</div><div class="line">  heap:       cnt=      1</div><div class="line">  mailbox:    cnt=      0</div><div class="line">  task:       cnt=     32</div><div class="line">  clock:      cnt=      0</div><div class="line">  hwi:        cnt=     15</div><div class="line">  timer:      cnt=      1</div><div class="line"></div><div class="line">CPU: mcu2_1</div><div class="line">  semaphore:  cnt=     42</div><div class="line">  mutex:      cnt=      0</div><div class="line">  queue:      cnt=      0</div><div class="line">  event:      cnt=      0</div><div class="line">  heap:       cnt=      1</div><div class="line">  mailbox:    cnt=      0</div><div class="line">  task:       cnt=     13</div><div class="line">  clock:      cnt=      0</div><div class="line">  hwi:        cnt=      6</div><div class="line">  timer:      cnt=      1</div><div class="line"></div><div class="line">CPU:  c7x_1</div><div class="line">  semaphore:  cnt=     37</div><div class="line">  mutex:      cnt=      0</div><div class="line">  queue:      cnt=      0</div><div class="line">  event:      cnt=      0</div><div class="line">  heap:       cnt=      1</div><div class="line">  mailbox:    cnt=      0</div><div class="line">  task:       cnt=     18</div><div class="line">  clock:      cnt=      0</div><div class="line">  hwi:        cnt=      4</div><div class="line">  timer:      cnt=      1</div><div class="line"></div><div class="line">CPU:  c7x_2</div><div class="line">  semaphore:  cnt=     30</div><div class="line">  mutex:      cnt=      0</div><div class="line">  queue:      cnt=      0</div><div class="line">  event:      cnt=      0</div><div class="line">  heap:       cnt=      1</div><div class="line">  mailbox:    cnt=      0</div><div class="line">  task:       cnt=     11</div><div class="line">  clock:      cnt=      0</div><div class="line">  hwi:        cnt=      4</div><div class="line">  timer:      cnt=      1</div><div class="line"></div><div class="line"></div><div class="line">APP: Deinit ... !!!</div><div class="line">REMOTE_SERVICE: Deinit ... !!!</div><div class="line">REMOTE_SERVICE: Deinit ... Done !!!</div><div class="line">IPC: Deinit ... !!!</div><div class="line">IPC: DeInit ... Done !!!</div><div class="line">MEM: Deinit ... !!!</div><div class="line">MEM: Alloc&#39;s: 0 alloc&#39;s of 0 bytes </div><div class="line">MEM: Free&#39;s : 0 free&#39;s  of 0 bytes </div><div class="line">MEM: Open&#39;s : 0 allocs  of 0 bytes </div><div class="line">MEM: Deinit ... Done !!!</div><div class="line">APP: Deinit ... Done !!!</div><div class="line">APP HEAP STATS: Done !!!</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
