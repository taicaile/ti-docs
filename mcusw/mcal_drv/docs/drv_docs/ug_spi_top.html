<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>MCUSW: Spi User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MCUSW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ug_spi_top.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Spi User Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="ug_spi_intro"></a>
Introduction</h1>
<p>This document details AUTOSAR BSW SPI module implementation</p><ul>
<li>Supported AUTOSAR Release <b>: 4.3.1</b></li>
<li>Supported Configuration Variants <b>: Post-build, Link-time, Pre-Compile</b></li>
<li>Vendor ID <b>: SPI_VENDOR_ID (44)</b></li>
<li>Module ID <b>: SPI_MODULE_ID (83)</b></li>
</ul>
<p>The SPI driver provides services for basic communication with external components. These components can be used by an application. The main tasks of the SPI driver are:</p><ul>
<li>Handle the SPI hardware units onboard – MCSPI</li>
<li>Handle data transmission to the components connected via SPI</li>
<li>Take care of the settings required by external components (baud rate etc.</li>
<li>DMA support has also been added to SPI module.</li>
</ul>
<hr/>
 <h1><a class="anchor" id="ug_spi_design"></a>
Spi Driver Architecture/Design</h1>
<p>Please refer the SPI design, which is included as part of release (<a class="el" href="design_spi_top.html">Spi Design Document</a>)</p>
<hr/>
 <h1><a class="anchor" id="ug_spi_functional_top"></a>
Functional Description</h1>
<p>The The Multi-channel Serial Peripheral Interface (MCSPI) is a master/slave synchronous serial bus. It allows a master device to initiate serial data transfers to a slave device.</p>
<p>Programming of clock source for the MCSPI, is beyond the scope of this document. The driver expects user of this module has programmed required clock source.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_id_mapping"></a>
Spi Instance ID mapping and ISR mapping</h2>
<p>Please refer to the SOC User Manual for detail.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_cfg"></a>
Configuration</h2>
<p>The Spi Driver implementation supports multiple configuration variants (refer section <a class="el" href="ug_spi_top.html#ug_spi_intro">Introduction</a>), the driver expects generated <b><a class="el" href="Spi__Cfg_8h.html" title="This file contains generated pre compile configuration file for SPI MCAL driver.">Spi_Cfg.h</a> </b> to be present as (<a class="el" href="ug_spi_top.html#ug_spi_functional_filestruct_top">File Structure</a>). Please refer (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_top">Build</a>) to specify path to generated configuration. The associated MCSPI configuration generated files <b>Spi_Cfg.c</b>, <b>Spi_Lcfg.c</b> and <b>Spi_PBcfg.c</b> to be present as show (<a class="el" href="ug_spi_top.html#ug_spi_functional_filestruct_top">File Structure</a>)</p>
<p>NOTE: Always use configurator tool for MCAL configuration generation.</p>
<p>The following section details on the un-supported features and additional features added.</p>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_cfg_v"></a>
Variance / Deviation from the specification</h3>
<hr/>
 <h4><a class="anchor" id="ug_spi_functional_cfg_v_baudrate"></a>
SpiBaudrate</h4>
<p>This parameter is the communication baudrate which allows using a range of values, from the point of view of configuration tools, from Hz up to MHz.This is achieved using modulespecific parameter SpiExtDeviceClockDivider</p>
<hr/>
 <h4><a class="anchor" id="ug_spi_functional_cfg_v_timeClk2Cs"></a>
SpiTimeClk2Cs</h4>
<p>This parameter is the timing between clock and chip select (in seconds) This parameter allows to use a range of values from 0 up to 0.0001 seconds. Range specified by AUTOSAR specification is not supported by SPI hardware. TI specific SpiCsIdleTime parameter is used instead of this.</p>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_i_cfg"></a>
Implementation Specific Configurations</h3>
<p>This driver implementation introduces below listed configurable options</p>
<p>Please refer the SPI design section NON Standard configurable parameters (Refer to Design Document provided in CSP), which is included as part of release (<a class="el" href="design_spi_top.html">Spi Design Document</a>)</p>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_i_cfg_cons"></a>
Implementation Specific Configuration Constraint</h3>
<p>This driver implementation introduces configurable constraint as mentioned below.</p>
<ul>
<li>Please define all the SPI instances defined in SpiHwUnitType.</li>
<li>Hw Unit Id 0 always corresponds to SPI_UNIT_MCU_MCSPI0.. and SPI_UNIT_MCSPI7 corresponds to 10.</li>
<li>So to use SPI_UNIT_MCSPI1, user needs to define SPI_UNIT_MCU_MCSPI0 SPI_UNIT_MCU_MCSPI1 SPI_UNIT_MCU_MCSPI2 SPI_UNIT_MCSPI0. <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Hw Unit Id  </th><th class="markdownTableHeadNone">SpiHwUnitType   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">SPI_UNIT_MCU_MCSPI0   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">SPI_UNIT_MCU_MCSPI1   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">SPI_UNIT_MCU_MCSPI2   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI0   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI1   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">5  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI2   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">6  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI3   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">7  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI4   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">8  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI5   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">9  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI6   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">10  </td><td class="markdownTableBodyNone">SPI_UNIT_MCSPI7   </td></tr>
</table>
</li>
<li>The loopback configuration is based only on the pinmux configuration from user. There is no API to disable it.</li>
</ul>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<h3><a class="anchor" id="ug_spi_functional_i_cfg_s_api_top"></a>
Non Standard Service APIs</h3>
<hr/>
 <h4><a class="anchor" id="ug_spi_functional_i_cfg_s_api_rb"></a>
Spi_RegisterReadback</h4>
<p>As noted from the previous MCAL implementation, some of the critical configuration registers could potentially be corrupted by other entities (s/w or h/w). One of the recommended detection methods would be to periodically read-back the configuration and confirm configuration is consistent. The service API defined below shall be implemented to enable this detection</p>
<table class="doxtable">
<tr>
<td><em><b> </b></em> </td><td><em><b>Description</b></em> </td><td><em><b> Comments</b></em>  </td></tr>
<tr>
<td><em><b>Service Name</b></em> </td><td>Spi_RegisterReadback </td><td>Can potentially be turned OFF (Refer to Design Document provided in CSP)   </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>uint32 Spi_RegisterReadback ( Spi_HWUnitType HWUnit, P2VAR(Spi_RegisterReadbackType, AUTOMATIC, SPI_APPL_DATA) RegRbPtr)  </td><td>E_OK: Register read back has been done, E_NOT_OK: Register read back failed   </td></tr>
<tr>
<td><em><b>Service ID </b></em> </td><td>NA  </td><td></td></tr>
<tr>
<td><em><b>Sync / Async </b></em> </td><td>Sync </td><td></td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Reentrant </td><td></td></tr>
<tr>
<td><em><b>Parameter in</b></em> </td><td>HWUnit </td><td>SPI Hardware microcontroller peripheral unit ID. If this is invalid, then the API will return E_NOT_OK.  </td></tr>
<tr>
<td><em><b>Parameters out</b></em> </td><td>RegRbPtr - Pointer to where to store the readback values. If this pointer is NULL_PTR, then the API will return E_NOT_OK. </td><td></td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>Std_ReturnType </td><td>E_OK, E_NOT_OK   </td></tr>
</table>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_cfg_int"></a>
Interrupt Configuration</h2>
<p>The Driver doesn’t register any interrupt service routine(ISR), it’s expected that consumer of this driver registers the required interrupt handler.</p>
<p>For every Spi instance an ISR needs to be registered. The Interrupt number associated with instance of the Spi is detailed in TRM. Please refer SpiApp_InterruptConfig () in Spi demo application.</p>
<p>Some of the spi interrupts are not routed/mapped to this core, these interrupts would require additional programming to route these to this core. Please refer SpiApp_InterruptConfig () in Spi demo application.</p>
<p>Dedicated interrupt lines are available from DMA after event completion to the R5 core (80-90 for MCU1_0) and (229 to 247 for MCU2_1).</p>
<p>Please refer mcusw\mcal_drv\mcal\examples_config\Spi_Demo_Cfg\output\generated\soc\j721e\mcu1_0\src\Spi_PBcfg.c for interrupt numbers.</p>
<p>Refer section (<a class="el" href="ug_spi_top.html#ug_spi_functional_id_mapping">Spi Instance ID mapping and ISR mapping</a>), for association between channel ID and ISR</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_cfg_pwr"></a>
Power-up</h2>
<p>The driver doesn't configure the functional clock and power for the spi modules. It's expected that secondary boot loader(SBL) power-up the required modules. Please refer SBL documentation.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_cfg_build"></a>
Build and Running the Application</h2>
<p>Please follow steps detailed in section (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_top">Build</a>) to build library or example</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_run_example"></a>
Steps to run example application</h2>
<p>Please follow steps detailed in section (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_top">Build</a>) to build example</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_cfg_memmap"></a>
Memory Mapping</h2>
<p>Various objects of this implementation (e.g. variables, functions, constants) are defined under different sections. The linker command file at (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_eg_linker">Examples Linker File (Select memory location to hold example binary)</a>) defines separate section for these objects. When the driver is integrated, its expected that these sections are created and placed in appropriate memory locations. (Locations of these objects depend on the system design and performance needs)</p>
<table class="doxtable">
<tr>
<td><em><b>Section</b></em> </td><td><em><b> SPI_CODE</b></em> </td><td><em><b> SPI_VAR</b></em> </td><td><em><b> SPI_VAR_NOINIT</b></em> </td><td><em><b> SPI_CONST</b></em> </td><td><em><b> SPI_CONFIG</b></em>  </td></tr>
<tr>
<td><em><b>SPI_START_SEC_VAR_INIT_UNSPECIFIED (.data)</b></em> </td><td></td><td>USED  </td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>SPI_DATA_INIT_32_SECTION </b></em> </td><td></td><td>USED  </td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>SPI_TEXT_SECTION </b></em> </td><td>USED  </td><td></td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>SPI_DATA_NO_INIT_UNSPECIFIED_SECTION </b></em> </td><td></td><td></td><td>USED  </td><td></td><td></td></tr>
<tr>
<td><em><b>SPI_CONST_32_SECTION </b></em> </td><td></td><td></td><td></td><td>USED  </td><td></td></tr>
<tr>
<td><em><b>SPI_ISR_TEXT_SECTION </b></em> </td><td>USED  </td><td></td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>SPI_CONFIG_SECTION </b></em> </td><td></td><td></td><td></td><td></td><td>USED   </td></tr>
</table>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_cfg_cache"></a>
Cache</h3>
<p>This driver implementation has been validated with cache enabled. For optimal performance it’s recommended to place (<a class="el" href="ug_spi_top.html#ug_spi_functional_cfg_memmap">Memory Mapping</a>) sections in cache enabled memory area.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_dep_top"></a>
Dependencies on SW Modules</h2>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_dep_det"></a>
DET</h3>
<p>This implementation depends on the DET in order to report development errors and can be turned OFF. Refer section (<a class="el" href="ug_spi_top.html#ug_spi_error_dev">Development Error Reporting</a>) for detailed error codes.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_spi_functional_dep_schm"></a>
SchM</h3>
<p>This implementation requires one level of exclusive access to guard critical sections. Invokes SchM_Enter_Spi_SPI_EXCLUSIVE_AREA_0 (), SchM_Exit_Spi_SPI_EXCLUSIVE_AREA_0 () to enter critical section and exit.</p>
<p>In the example implementation (<a class="el" href="ug_spi_top.html#ug_spi_functional_filestruct_top">File Structure</a> SchM_Spi.c) , all the interrupts on CPU are disabled. However, disabling of the enabled Spi interrupt should suffice.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_functional_filestruct_top"></a>
File Structure</h2>
<div class="image">
<img src="spi_design_dir_structure.png" alt="spi_design_dir_structure.png"/>
<div class="caption">
Detailed Directory Structure</div></div>
<ol type="1">
<li>Driver implemented by : <a class="el" href="Spi_8h.html" title="This file contains interface header for SPI MCAL driver.">Spi.h</a>, <a class="el" href="Spi__Irq_8h.html" title="This file contains ISR function declaration for SPI MCAL driver.">Spi_Irq.h</a>, Spi.c, Spi_Priv.c,Spi_Mcspi.c Spi_Irq.c and Spi_Priv.h</li>
<li>Example Configuration by : <a class="el" href="Spi__Cfg_8h.html" title="This file contains generated pre compile configuration file for SPI MCAL driver.">Spi_Cfg.h</a>, Spi_Cfg.c,Spi_Lcfg.c and Spi_PBcfg.c</li>
<li>Example Application by : McspiApp.c and McspiApp.h</li>
</ol>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_spi_error_top"></a>
Error Handling</h1>
<hr/>
 <h2><a class="anchor" id="ug_spi_error_dev"></a>
Development Error Reporting</h2>
<p>Development errors are reported to the DET using the service Det_ReportError(), when enabled. The driver interface (<a class="el" href="Spi_8h.html" title="This file contains interface header for SPI MCAL driver.">Spi.h</a> <a class="el" href="ug_spi_top.html#ug_spi_functional_filestruct_top">File Structure</a>) lists the SID</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_error_codes"></a>
Error codes</h2>
<table class="doxtable">
<tr>
<td><em><b> Type of Error </b></em> </td><td><em><b> Related Error code </b></em> </td><td><em><b> Value (Hex)</b></em>  </td></tr>
<tr>
<td>Channel out of bounds, exceeds the maximum number of configured channels  </td><td>SPI_E_PARAM_CHANNEL  </td><td>0x0A   </td></tr>
<tr>
<td>Job out of bounds, exceeds the maximum number of configured jobs  </td><td>SPI_E_PARAM_JOB  </td><td>0x0B   </td></tr>
<tr>
<td>Sequence out of bounds, exceeds the maximum number of configured sequences  </td><td>SPI_E_PARAM_SEQ  </td><td>0x0C   </td></tr>
<tr>
<td>Length out of bounds, exceeds the maximum number of configured EB- or IB- buffer length  </td><td>SPI_E_PARAM_LENGTH  </td><td>0x0D   </td></tr>
<tr>
<td>The requested hardware unit does not exist  </td><td>SPI_E_PARAM_UNIT  </td><td>0x0E   </td></tr>
<tr>
<td>An invalid configuration has been passed (i.e. a NULL_PTR). This is an extension to AUTOSAR.  </td><td>SPI_E_PARAM_POINTER  </td><td>0x10   </td></tr>
<tr>
<td>A service was requested, but the driver has not been initialized  </td><td>SPI_E_UNINIT  </td><td>0x1A   </td></tr>
<tr>
<td>The requested sequence is still pending  </td><td>SPI_E_SEQ_PENDING  </td><td>0x2A   </td></tr>
<tr>
<td>Transmission of synchronous sequence in progress (not supported) </td><td>SPI_E_SEQ_IN_PROCESS  </td><td>0x3A   </td></tr>
<tr>
<td>The driver is already initialized.  </td><td>SPI_E_ALREADY_INITIALIZED  </td><td>0x4A   </td></tr>
</table>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_error_prod"></a>
Production Code Error Reporting</h2>
<p>Production error are reported to DEM via the service DEM_ReportErrorStatus(). In addition to standard errors, this implementation reports "SPI_E_HARDWARE_ERROR" when SPI Timer register hardware reset fails.</p>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_spi_api_top"></a>
API Description</h1>
<p>The AUTOSAR BSW Spi Driver specification details the APIs required for Spi Driver. Please refer to (Refer to Design Document provided in CSP) for detailed API description. Also refer to (<a class="el" href="ug_spi_top.html#ug_spi_functional_i_cfg_s_api_top">Non Standard Service APIs</a>) for non-standard APIs which are included in this implemented.</p>
<p><a class="el" href="group__MCAL__SPIHANDLER__API.html">Refer API Documentation for details</a> <a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_spi_eg_top"></a>
Example Application</h1>
<p>The example application demonstrate use of Spi module, the list below identifies key steps performed the example. The configuration file is present at (<a class="el" href="ug_spi_top.html#ug_spi_functional_filestruct_top">File Structure</a>)</p>
<p>MCSPI example app is ported and tested with single MCSPI instance on MCU1_0 and MCU2_1 cores using UDMA MCU and MAIN NAVSS respectively. MCU MCSPI Instance on MCU1_0 core and MCSPI3 Instance on MCU2_1.</p>
<p>Please note that Multiple MCSPI Instances configuration is not tested.</p>
<p>Either interrupt/polling or DMA mode is supported per MCSPI instance for each configuration.Both modes are not supported simultaneously. Note: Spi_SetAsyncMode API should be bypassed in application is DMA mode if enabled.</p>
<ul>
<li>Initializes “Result Status Flag”</li>
<li>SpiApp_Startup ()<ul>
<li>Builds interrupt list and registers ISR for enabled Spi instances</li>
<li>Pinmux configuration required for internal loopback testing mode</li>
</ul>
</li>
<li>SpiApp_PowerAndClkSrc ()<ul>
<li>Dummy function for now.</li>
</ul>
</li>
<li>Core application ()<ul>
<li>For each enabled instance<ul>
<li>Initialize Spi hardware</li>
<li>Enable loopback mode</li>
<li>Prints module version info</li>
<li>Set Async/Sync mode</li>
<li>Set Up and Initialize Tx and Rx Buffers</li>
<li>Start Sequence transmission</li>
<li>Wait for transmission completion</li>
<li>Get Sequence result</li>
<li>Compare Tx and Rx Buffers</li>
<li>De-Initialize Spi hardware</li>
</ul>
</li>
</ul>
</li>
<li>Checks for error status, stack corruption and prints result</li>
</ul>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_spi_eg_log"></a>
Example Log</h2>
<pre class="fragment">    SPI_APP: Sample Application - STARTS !!!

    SPI MCAL Version Info
    ---------------------
    Vendor ID           : 44
    Module ID           : 83
    SW Major Version    : 0
    SW Minor Version    : 1
    SW Patch Version    : 0

    SPI_APP: CH 1: JOBS 1: SEQ 1: HWUNIT 1: NUM OF WORDS 10000:!!!
    SPI_APP: Variant - Post Build being used !!!
    SPI_APP: SPI Async transmit in progress!!
    SPI_APP: SPI Stack Usage: 792 bytes
    SPI_APP: SPI Loopback Test Passed!!!</pre><p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_spi_ref_top"></a>
References</h1>
<ul>
<li><a class="el" href="design_spi_top.html">Design Page</a></li>
<li><a href="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-3/AUTOSAR_SWS_SPIHandlerDriver.pdf">AUTOSAR Spec : Internet Link</a></li>
</ul>
<p><a class="el" href="ug_spi_top.html#ug_spi_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_spi_rev_hist"></a>
Document Revision History</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Revision  </th><th class="markdownTableHeadNone">Date  </th><th class="markdownTableHeadNone">Author  </th><th class="markdownTableHeadNone">Description  </th><th class="markdownTableHeadNone">Status   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.1  </td><td class="markdownTableBodyNone">14 Oct 2018  </td><td class="markdownTableBodyNone">Sunil M S  </td><td class="markdownTableBodyNone">First version  </td><td class="markdownTableBodyNone">Pending Review   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.2  </td><td class="markdownTableBodyNone">22 Oct 2018  </td><td class="markdownTableBodyNone">Sunil M S  </td><td class="markdownTableBodyNone">Addressed review comments  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.3  </td><td class="markdownTableBodyNone">16 Oct 2018  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Added Logs from J721E testing  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.4  </td><td class="markdownTableBodyNone">02 Nov 2020  </td><td class="markdownTableBodyNone">Nikki S  </td><td class="markdownTableBodyNone">J7200 updated  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.5  </td><td class="markdownTableBodyNone">16 Mar 2021  </td><td class="markdownTableBodyNone">Nikki S  </td><td class="markdownTableBodyNone">DMA Updates  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.6  </td><td class="markdownTableBodyNone">17 Mar 2022  </td><td class="markdownTableBodyNone">Rohit T  </td><td class="markdownTableBodyNone">Removed J721E &amp; J7200 specific contents  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.7  </td><td class="markdownTableBodyNone">08 Dec 2022  </td><td class="markdownTableBodyNone">Subham Swain  </td><td class="markdownTableBodyNone">J721S2 updated  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.8  </td><td class="markdownTableBodyNone">04 Mar 2023  </td><td class="markdownTableBodyNone">Subham Swain  </td><td class="markdownTableBodyNone">Spi_SetLoopbackMode info removed  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.9  </td><td class="markdownTableBodyNone">10 April 2023  </td><td class="markdownTableBodyNone">Rohit T  </td><td class="markdownTableBodyNone">Fixed doxygen warnings  </td><td class="markdownTableBodyNone">Approved   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mcal_ug_top.html">MCAL Module User Guide</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
