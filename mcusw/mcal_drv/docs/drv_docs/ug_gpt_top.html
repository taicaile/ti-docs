<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>MCUSW: Gpt User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MCUSW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ug_gpt_top.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Gpt User Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="ug_gpt_intro"></a>
Introduction</h1>
<p>This document details AUTOSAR BSW GPT module implementation</p><ul>
<li>Supported AUTOSAR Release <b>: 4.3.1</b></li>
<li>Supported Configuration Variants <b>: Post-build, Pre-Compile</b></li>
<li>Vendor ID <b>: GPT_VENDOR_ID (44)</b></li>
<li>Module ID <b>: GPT_MODULE_ID (100)</b></li>
</ul>
<p>The GPT module initializes, configures and controls the internal Timer(s) hardware to realize GPT driver as detailed in AUTOSAR BSW GPT Driver Specification. Following section highlights key aspects of this implementation, which would of interest to an integrator.</p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_design"></a>
Gpt Driver Architecture/Design</h1>
<p>Please refer the GPT design, which is included as part of release (<a class="el" href="design_gpt_top.html">Gpt Design Document</a>)</p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_functional_top"></a>
Functional Description</h1>
<h2><a class="anchor" id="ug_gpt_functional_clksrc"></a>
Clock Source to timers</h2>
<p>The Timer hardware is down-counter that count from non-zero value to zero. The clock supplied to these timers determines the rate of count-down. For each timer, clock source can be programmable and frequency of the clock varies on the SoC being used.</p>
<p>Programming of clock source for the timer, is beyond the scope of this document. The driver expects user of this module has programmed required clock source. The example application demonstrates configuring clock sources for the timer. Please note that “Gpt_ValueType Value” used in API Gpt_StartTimer () is a function of the clock source to the timer.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_clkcompute"></a>
Computing the Gpt_ValueType Value for API Gpt_StartTimer ()</h3>
<p>Value can be expressed as function of clock provided to timer with following equation. </p><pre class="fragment">Value = &lt;Clock Frequency in MHz&gt; * &lt;Required Time duration in seconds&gt;
</pre><p>e.g.</p><ul>
<li>second duration for a 12.5 MHz clock source would be <b>78643200</b> = (1024 * 1024 * 12.5) * 6</li>
<li>millisecond duration for a 12.5 MHz clock source would be <b>13107</b> = (1024 * 1024 * 12.5) * 0.001</li>
</ul>
<p>Also refer (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_i_cfg_prescale">GptChannelPrescale</a>)</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_id_mapping"></a>
Timer Instance, Gpt Channel ID mapping and ISR mapping</h2>
<p>All timer instances are supported by this driver implementation (Timers in Main Domain &amp; MCU Domain). The following table lists the mapping between instance of timer and GptChannelId of the configurator</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">GptChannelId  </th><th class="markdownTableHeadNone">Timer Instance  </th><th class="markdownTableHeadNone">Associated ISR (if notification is enabled)   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">MCU TIMER 0  </td><td class="markdownTableBodyNone">Gpt_Ch1Isr   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">MCU TIMER 1  </td><td class="markdownTableBodyNone">Gpt_Ch2Isr   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">9  </td><td class="markdownTableBodyNone">MCU TIMER 9  </td><td class="markdownTableBodyNone">Gpt_Ch10Isr   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">10  </td><td class="markdownTableBodyNone">TIMER 0  </td><td class="markdownTableBodyNone">Gpt_Ch11Isr   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">11  </td><td class="markdownTableBodyNone">TIMER 1  </td><td class="markdownTableBodyNone">Gpt_Ch12Isr   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.  </td><td class="markdownTableBodyNone">.   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">29  </td><td class="markdownTableBodyNone">TIMER 29  </td><td class="markdownTableBodyNone">Gpt_Ch30Isr   </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_cfg"></a>
Configuration</h2>
<p>The Gpt Driver implementation supports multiple configuration variants (refer section <a class="el" href="ug_gpt_top.html#ug_gpt_intro">Introduction</a>), the driver expects generated <b><a class="el" href="Gpt__Cfg_8h.html" title="This file contains generated pre compile configurations for GPT MCAL driver.">Gpt_Cfg.h</a> </b> to be present as (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_filestruct_top">File Structure</a>). Please refer (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_top">Build</a>) to specify path to generated configuration. The associated timer configuration generated files <b>Gpt_Cfg.c</b> and <b>Gpt_PBcfg.c</b> to be present as show (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_filestruct_top">File Structure</a>)</p>
<p>NOTE: Always use configurator tool for MCAL configuration generation.</p>
<p>The following section details on the un-supported features and additional features added.</p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_cfg_v"></a>
Variance / Deviation from the specification</h3>
<h4><a class="anchor" id="ug_gpt_functional_cfg_v_predef"></a>
PreDef Timers</h4>
<p>This driver implementation doesn’t implement PreDef Timers. As Gpt would require to access/configure registers which are common (not just the Timer hardware module - clock source)</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_cfg_v_clksrc"></a>
GptClockReference</h4>
<p>To configure the clock source for Gpt (Timer hardware), one would have to access/configure common registers. It’s recommended that clock sources for the Gpt (Timer hardware) are done in SBL / Start up code.</p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_cfg_v_clkfreq"></a>
GptChannelTickFrequency</h4>
<p>The GptChannelTickFrequency, parameter is not used in this implementation</p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_i_cfg"></a>
Implementation Specific Configurations</h3>
<p>This driver implementation introduces below listed configurable options</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_var"></a>
GptDeviceVariant</h4>
<table class="doxtable">
<tr>
<td><em><b>Name</b></em> </td><td>GptDeviceVariant  </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td>Used to specific family of devices, the variant of the device being used will belong one or more family of devices. Please refer (<a class="el" href="mcusw_c_ug_top.html#mcusw_supported_family">Supported Device Families</a>) to determine the family of device. Based on the family, the number of instances of Timer module supported could vary.   </td></tr>
<tr>
<td><em><b>Container Name</b></em> </td><td>GptDriverConfiguration  </td></tr>
<tr>
<td><em><b>Type</b></em> </td><td>Enumeration  </td></tr>
<tr>
<td><em><b>Range</b></em> </td><td>TDA4x, etc… (new family of devices could be added in future)  </td></tr>
<tr>
<td><em><b>Value Configuration Class</b></em> </td><td>VARIANT-PRE-COMPILE  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_isr"></a>
GptCategoryOfIsr</h4>
<table class="doxtable">
<tr>
<td><em><b>Name</b></em> </td><td>GptCategoryOfIsr  </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td>Specifies category of ISR.  </td></tr>
<tr>
<td><em><b>Container Name</b></em> </td><td>GptDriverConfiguration  </td></tr>
<tr>
<td><em><b>Type</b></em> </td><td>Enumeration  </td></tr>
<tr>
<td><em><b>Range</b></em> </td><td>GPT_ISR_CAT1 &amp; GPT_ISR_CAT2  </td></tr>
<tr>
<td><em><b>Value Configuration Class</b></em> </td><td>VARIANT-PRE-COMPILE  </td></tr>
<tr>
<td><em><b>Note</b></em> </td><td>This implementation has been validated with GPT_ISR_CAT1 only  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_ctrid"></a>
GptDefaultOSCounterId</h4>
<table class="doxtable">
<tr>
<td><em><b>Name</b></em> </td><td>GptDefaultOSCounterId  </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td><p class="starttd">Specifies the OS counter to be used by the driver. All wait operations (wait for hardware timer module reset to complete) are time bound.</p>
<p class="intertd">This implementation uses OS calls (GetCounterValue () &amp; GetElapsedValue ()) to get current and elapsed time to establish time bound operation.</p>
<p class="endtd">In cases where a constant value is returned / OS call is not operational, the time bound operation cannot be realized.   </p>
</td></tr>
<tr>
<td><em><b>Container Name</b></em> </td><td>GptDriverConfiguration  </td></tr>
<tr>
<td><em><b>Type</b></em> </td><td>Boolean  </td></tr>
<tr>
<td><em><b>Value Configuration Class</b></em> </td><td>VARIANT-PRE-COMPILE  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_s_api"></a>
GptRegisterReadbackApi</h4>
<table class="doxtable">
<tr>
<td><em><b>Name</b></em> </td><td>GptRegisterReadbackApi  </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td>Adds / Removes service API Gpt_RegisterReadback () <pre class="fragment">Safety feature : Some of the critical registers (corruption of which
could potentially break functionality of the Gpt/Timer)

The expected usage: Periodically this service API is invoked and
checked for data-consistency. i.e. the values of members of structure
Gpt_RegisterReadbackType is not expected to change.

Also refer (@ref ug_gpt_functional_i_cfg_s_api_imp)
</pre>   </td></tr>
<tr>
<td><em><b>Container Name</b></em> </td><td>GptConfigurationOfOptApiServices  </td></tr>
<tr>
<td><em><b>Type</b></em> </td><td>Boolean  </td></tr>
<tr>
<td><em><b>Value Configuration Class</b></em> </td><td>VARIANT-PRE-COMPILE  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_prescale"></a>
GptChannelPrescale</h4>
<table class="doxtable">
<tr>
<td><em><b>Name</b></em> </td><td>GptChannelPrescale  </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td><p class="starttd">Used configure divider for the input clock, as discussed in section (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_clkcompute">Computing the Gpt_ValueType Value for API Gpt_StartTimer ()</a>) the clock source is used as time base.</p>
<p class="endtd">This parameter could be used to divide this clock before it’s used to count.   </p>
</td></tr>
<tr>
<td><em><b>Container Name</b></em> </td><td>GptChannelConfigSet  </td></tr>
<tr>
<td><em><b>Type</b></em> </td><td>Enumeration  </td></tr>
<tr>
<td><em><b>Range</b></em> </td><td>GPT_PRESCALER_NO_PRESCALE : Divider is disabled GPT_PRESCALER_CLK_DIV_BY_2 : Clock is divided by 2 : GPT_PRESCALER_CLK_DIV_BY_256: Clock is divided by 256   </td></tr>
<tr>
<td><em><b>Value Configuration Class</b></em> </td><td>VARIANT-PRE-COMPILE &amp; VARIANT-POST-BUILD  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
<h3><a class="anchor" id="ug_gpt_functional_i_cfg_s_api_top"></a>
Non Standard Service APIs</h3>
<hr/>
 <h4><a class="anchor" id="ug_gpt_functional_i_cfg_s_api_imp"></a>
Gpt_RegisterReadback</h4>
<p>To protect HW from un-intended re-configuration (corrupted / fault hardware), some of the critical registers are read periodically and checked. By an entity outside the driver, the values of these registers are not expected to change. This is an optional service API, which can be turned OFF (refer section <a class="el" href="ug_gpt_top.html#ug_gpt_functional_i_cfg_s_api">GptRegisterReadbackApi</a>)</p>
<table class="doxtable">
<tr>
<td><em><b>Service Name</b></em> </td><td>Gpt_RegisterReadback  </td></tr>
<tr>
<td><em><b>Syntax</b></em> </td><td>void Gpt_RegisterReadback (Gpt_ChannelType GptChannel, <a class="el" href="structGpt__RegisterReadbackType.html" title="GPT register readback structure.">Gpt_RegisterReadbackType</a> * RegRbPtr)   </td></tr>
<tr>
<td><em><b>Service ID[hex]</b></em> </td><td>0x0F  </td></tr>
<tr>
<td><em><b>Sync/Async</b></em> </td><td>Synchronous   </td></tr>
<tr>
<td><em><b>Reentrancy</b></em> </td><td>Reentrant (but not for the same timer channel)   </td></tr>
<tr>
<td><em><b>Parameters (in)</b></em> </td><td>GptChannel : Numeric identifier of the GPT channel  </td></tr>
<tr>
<td><em><b>Parameters (inout)</b></em> </td><td>RegRbPtr : Pointer of type <a class="el" href="structGpt__RegisterReadbackType.html" title="GPT register readback structure.">Gpt_RegisterReadbackType</a>  </td></tr>
<tr>
<td><em><b>Parameters (out)</b></em> </td><td>None  </td></tr>
<tr>
<td><em><b>Return Value</b></em> </td><td>E_OK: Register read back has been done E_NOT_OK: Register read back failed (if channel is not initialized or RegRbPtr is NULL_PTR   </td></tr>
<tr>
<td><em><b>Description</b></em> </td><td>Reads the important registers of the hardware unit and returns the value in the structure.  </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_cfg_int"></a>
Interrupt Configuration</h2>
<p>The Driver doesn’t register any interrupts handler (ISR), it’s expected that consumer of this driver registers the required interrupt handler.</p>
<p>For every Gpt channel with notification enabled, an ISR requires to be registered. The Interrupt number associated with instance of the Timer is detailed in TRM (also, please refer the demo application). Please refer GptApp_InterruptConfig () in Gpt demo application.</p>
<p>Some of the Timer interrupts are not routed/mapped to this core, these interrupts would require additional programming to route these to this core. Please refer GptApp_InterruptConfig () in Gpt demo application.</p>
<p>Refer section (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_id_mapping">Timer Instance, Gpt Channel ID mapping and ISR mapping</a>), for association between channel ID and ISR</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_cfg_pwr"></a>
Power-up</h2>
<p>The driver doesn't configured the functional clock and power for the timer modules. Its expected that SBL power-up the required modules. Please refer SBL documentation.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_cfg_build"></a>
Build and Running the Example Application</h2>
<p>Please follow steps detailed in section (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_top">Build</a>) to build library or example</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_eg_app"></a>
Example Application</h2>
<ul>
<li>Support both Post Build and Pre Compile Configuration Variants</li>
<li>For each Configured Timer, with default configuration provided in the release<ul>
<li>A time duration of ~6 seconds is configured</li>
<li>Extracts and prints timer status during this period</li>
<li>Demonstrates use of TimeLapsed, TimeRemaining API's</li>
<li>Demonstrates Wakeup functionality</li>
</ul>
</li>
</ul>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_run_example"></a>
Steps to run example application</h2>
<p>Please refer (<a class="el" href="mcusw_c_ug_top.html#mcusw_run_eg">Running Examples</a>)</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_cfg_memmap"></a>
Memory Mapping</h2>
<p>Various objects of this implementation (e.g. variables, functions, constants) are defined under different sections. The linker command file at (<a class="el" href="mcusw_c_ug_top.html#mcusw_build_eg_linker">Examples Linker File (Select memory location to hold example binary)</a>) defines separate section for these objects. When the driver is integrated, its expected that these sections are created and placed in appropriate memory locations. (Locations of these objects depend on the system design and performance needs)</p>
<table class="doxtable">
<tr>
<td><em><b>Section</b></em> </td><td><em><b> GPT_CODE</b></em> </td><td><em><b> GPT_VAR</b></em> </td><td><em><b> GPT_VAR_NOINIT</b></em> </td><td><em><b> GPT_CONST</b></em> </td><td><em><b> GPT_CONFIG</b></em>  </td></tr>
<tr>
<td><em><b>GPT_START_SEC_VAR_INIT_UNSPECIFIED (.data)</b></em> </td><td></td><td>USED  </td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>GPT_DATA_INIT_32_SECTION </b></em> </td><td></td><td>USED  </td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>GPT_TEXT_SECTION </b></em> </td><td>USED  </td><td></td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>GPT_DATA_NO_INIT_UNSPECIFIED_SECTION </b></em> </td><td></td><td></td><td>USED  </td><td></td><td></td></tr>
<tr>
<td><em><b>GPT_CONST_32_SECTION </b></em> </td><td></td><td></td><td></td><td>USED  </td><td></td></tr>
<tr>
<td><em><b>GPT_ISR_TEXT_SECTION </b></em> </td><td>USED  </td><td></td><td></td><td></td><td></td></tr>
<tr>
<td><em><b>GPT_CONFIG_SECTION </b></em> </td><td></td><td></td><td></td><td></td><td>USED   </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_cfg_cache"></a>
Cache</h3>
<p>This driver implementation has been validated with cache enabled. For optimal performance it’s recommended to place (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_cfg_memmap">Memory Mapping</a>) sections in cache enabled memory area.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_dep_top"></a>
Dependencies on SW Modules</h2>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_dep_det"></a>
DET</h3>
<p>This implementation depends on the DET in order to report development errors and can be turned OFF. Refer section (<a class="el" href="ug_gpt_top.html#ug_gpt_error_dev">Development Error Reporting</a>) for detailed error codes.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_dep_ecum"></a>
Module EcuM</h3>
<p>When wakeup is enabled, this implementation reports the wakeup interrupts to the ECU State Manager for further processing.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h3><a class="anchor" id="ug_gpt_functional_dep_schm"></a>
SchM</h3>
<p>This implementation requires 1 level of exclusive access to guard critical sections. Invokes SchM_Enter_Gpt_GPT_EXCLUSIVE_AREA_0 (), SchM_Exit_Gpt_GPT_EXCLUSIVE_AREA_0 () to enter critical section and exit.</p>
<p>In the example implementation (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_filestruct_top">File Structure</a> SchM_Gpt.c) , all the interrupts on CPU are disabled. However, disabling of the enabled Timer/Gpt interrupt should suffice.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_functional_filestruct_top"></a>
File Structure</h2>
<div class="image">
<img src="gpt_design_timer_dir_detailed.png" alt="gpt_design_timer_dir_detailed.png"/>
<div class="caption">
Detailed Directory Structure</div></div>
<ol type="1">
<li>Driver implemented by : <a class="el" href="Gpt_8h.html" title="This file contains interface header for GPT MCAL driver.">Gpt.h</a>, <a class="el" href="Gpt__Irq_8h.html" title="This file contains ISR function declaration for GPT MCAL driver.">Gpt_Irq.h</a>, Gpt.c, Gpt_Gptimer.c, Gpt_Irq.c and Gpt_Priv.h</li>
<li>Example Configuration by : <a class="el" href="Gpt__Cfg_8h.html" title="This file contains generated pre compile configurations for GPT MCAL driver.">Gpt_Cfg.h</a>, Gpt_Cfg.c and Gpt_PBcfg.c</li>
<li>Example Application by : GptApp.c and GptApp.h</li>
</ol>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_error_top"></a>
Error Handling</h1>
<hr/>
 <h2><a class="anchor" id="ug_gpt_error_dev"></a>
Development Error Reporting</h2>
<p>Development errors are reported to the DET using the service Det_ReportError(), when enabled. The driver interface (<a class="el" href="Gpt_8h.html" title="This file contains interface header for GPT MCAL driver.">Gpt.h</a> <a class="el" href="ug_gpt_top.html#ug_gpt_functional_filestruct_top">File Structure</a>) lists the SID</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_error_codes"></a>
Error codes</h2>
<table class="doxtable">
<tr>
<td><em><b> Type of Error </b></em> </td><td><em><b> Related Error code </b></em> </td><td><em><b> Value (Hex)</b></em>  </td></tr>
<tr>
<td>API service called without module initialization  </td><td>GPT_E_UINIT  </td><td>0x0A   </td></tr>
<tr>
<td>API service is called when timer channel is still busy  </td><td>GPT_E_BUSY  </td><td>0x0B   </td></tr>
<tr>
<td>API service for initialization is called when already initialized  </td><td>GPT_E_ALREADY_INITIALIZED  </td><td>0x0D   </td></tr>
<tr>
<td>API parameter checking: invalid channel  </td><td>GPT_E_PARAM_CHANNEL  </td><td>0x14   </td></tr>
<tr>
<td>API parameter checking: invalid value  </td><td>GPT_E_PARAM_VALUE  </td><td>0x15   </td></tr>
<tr>
<td>API parameter checking: invalid pointer  </td><td>GPT_E_PARAM_POINTER  </td><td>0x16   </td></tr>
<tr>
<td>API parameter checking: invalid mode  </td><td>GPT_E_PARAM_MODE  </td><td>0x1F   </td></tr>
</table>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_error_prod"></a>
Production Code Error Reporting</h2>
<p>Production error are reported to DEM via the service DEM_ReportErrorStatus(). In addition to standard errors, this implementation reports "GPT_E_HARDWARE_ERROR" when GPT Timer register hardware reset fails.</p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_api_top"></a>
API Description</h1>
<p>The AUTOSAR BSW Gpt Driver specification details the API, as listed in section (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_cfg_v_predef">PreDef Timers</a>), following API’s are not implemented</p><ul>
<li>Gpt_GetPredefTimerValue ( )</li>
<li>Other service API’s such as Gpt_Init (), Gpt_DeInit (), Gpt_SetMode ()etc… will not perform any actions associated with Pre Def Timer</li>
</ul>
<p><a class="el" href="group__MCAL__GPT__API.html">Refer API Documentation for details</a></p>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_eg_top"></a>
Example Application</h1>
<p>The example application demonstrate use of Gpt module, the list below identifies key steps performed the example. The configuration file is present at (<a class="el" href="ug_gpt_top.html#ug_gpt_functional_filestruct_top">File Structure</a>)</p>
<ul>
<li>Initializes “Result Status Flag”</li>
<li>GptApp_Startup ()<ul>
<li>Clear any pre-running timers</li>
<li>Builds interrupt list and registers ISR for enabled Gpt channels</li>
<li>Sets up clock sources for the timer modules</li>
</ul>
</li>
<li>GptApp_mainTest ()<ul>
<li>For each enabled channel<ul>
<li>Enables Notification (if notification is enabled)</li>
<li>Starts Gpt</li>
<li>Prints channel status until notification is received (if notification is enabled)</li>
<li>Disable notification (if notification is enabled)</li>
<li>Wait for Timer expiry (if not in one shot mode)</li>
<li>Stop Gpt</li>
<li>Enable Wakeup (if enabled)</li>
<li>Re Start Gpt</li>
<li>Set Sleep mode</li>
<li>Waits for wakeup notification</li>
<li>Stops Gpt</li>
</ul>
</li>
</ul>
</li>
<li>Checks for error status, stack corruption and prints result</li>
</ul>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h2><a class="anchor" id="ug_gpt_eg_log"></a>
Example Log</h2>
<pre class="fragment">        GPT_APP: Building Interrupt List !!!
        GPT_APP: Variant - Post Build being used !!!
        GPT_APP: Interrupt List Completed !!!
        GPT_APP: rmIrqReq = 0
        GPT_APP: rmIrqReq = 0
        GPT_APP: rmIrqReq = 0

        GPT_APP: Sample Application - STARTS !!!
        GPT_APP: Variant - Post Build being used !!!

        GPT_APP GPT MCAL Version Info
        GPT_APP---------------------
        GPT_APP Vendor ID           : 44
        GPT_APP Module ID           : 100
        GPT_APP SW Major Version    : 2
        GPT_APP SW Minor Version    : 0
        GPT_APP SW Patch Version    : 0


        GPT_APP------------------------------------------
        GPT_APP: GPT Channel 11 configuration register values  
        GPT_APP TIMER_TIDR         : 0x50003900
        GPT_APP TIMER_TTGR         : 0xffffffff
        GPT_APP TIMER_TSICR        : 0x0
        GPT_APP TIMER_TIOCP_CFG    : 0xa
        GPT_APP TIMER_TCLR         : 0x0
        ------------------------------------------
        GPT_APP: Running GPT Test for channel 11
        ------------------------------------------
        GPT_APP: Enabled notification for channel [11]
        GPT_APP: Started Timer Channel [11]
        GPT_APP: Elapsed Time Value = adb48
        GPT_APP: Wait for notification(approx. 6 seconds)
        GPT_APP: GPT Notification received for channel 11 !!!

        GPT_APP: Disable channel notification for this channel

        GPT_APP: Stopped for channel 11
        GPT_APP: Enable wakeup for this channel
        GPT_APP: Started timer channel [11]
        GPT_APP: check if this channel is wakeup source for any wakeup event
        EcuM : Wakeup event received for wakeupSource =0 !!!
        GPT_APP: Woken up for channel [11]
        GPT_APP: Stop timer
        GPT_APP: GPT example passed for channel =11 !!!

        GPT_APP------------------------------------------
        GPT_APP: GPT Channel 6 configuration register values  
        GPT_APP TIMER_TIDR         : 0x50003900
        GPT_APP TIMER_TTGR         : 0xffffffff
        GPT_APP TIMER_TSICR        : 0x0
        GPT_APP TIMER_TIOCP_CFG    : 0xa
        GPT_APP TIMER_TCLR         : 0x0
        ------------------------------------------
        GPT_APP: Running GPT Test for channel 6
        ------------------------------------------
        GPT_APP: Enabled notification for channel [6]
        GPT_APP: Started Timer Channel [6]
        GPT_APP: Elapsed Time Value = adaee
        GPT_APP: Wait for notification(approx. 6 seconds)
        GPT_APP: GPT Notification received for channel 6 !!!

        GPT_APP: Disable channel notification for this channel
        GPT_APP: Wait till timer overflows, no notification should be received
        GPT_APP: Time Elapsed Value = 0x36ddc1
        GPT_APP: Time Remaining Value = 0x8adec39
        GPT_APP: Waiting for timer to overflow
        GPT_APP: Overflow happened no notification received

        GPT_APP: Stopped for channel 6
        GPT_APP: Enable wakeup for this channel
        GPT_APP: Started timer channel [6]
        GPT_APP: check if this channel is wakeup source for any wakeup event
        EcuM : Wakeup event received for wakeupSource =0 !!!
        GPT_APP: Woken up for channel [6]
        GPT_APP: Stop timer
        GPT_APP: GPT example passed for channel =6 !!!

        GPT_APP------------------------------------------
        GPT_APP: GPT Channel 9 configuration register values  
        GPT_APP TIMER_TIDR         : 0x50003900
        GPT_APP TIMER_TTGR         : 0xffffffff
        GPT_APP TIMER_TSICR        : 0x0
        GPT_APP TIMER_TIOCP_CFG    : 0xa
        GPT_APP TIMER_TCLR         : 0x0
        ------------------------------------------
        GPT_APP: Running GPT Test for channel 9
        ------------------------------------------
        GPT_APP: Enabled notification for channel [9]
        GPT_APP: Started Timer Channel [9]
        GPT_APP: Elapsed Time Value = adaee
        GPT_APP: Wait for notification(approx. 6 seconds)
        GPT_APP: GPT Notification received for channel 9 !!!

        GPT_APP: Disable channel notification for this channel
        GPT_APP: Wait till timer overflows, no notification should be received
        GPT_APP: Time Elapsed Value = 0x36dda0
        GPT_APP: Time Remaining Value = 0x8adec72
        GPT_APP: Waiting for timer to overflow
        GPT_APP: Overflow happened no notification received

        GPT_APP: Stopped for channel 9
        GPT_APP: Enable wakeup for this channel
        GPT_APP: Started timer channel [9]
        GPT_APP: check if this channel is wakeup source for any wakeup event
        EcuM : Wakeup event received for wakeupSource =0 !!!
        GPT_APP: Woken up for channel [9]
        GPT_APP: Stop timer
        GPT_APP: GPT example passed for channel =9 !!!

        GPT_APP------------------------------------------
        GPT_APP: GPT Channel 15 configuration register values  
        GPT_APP TIMER_TIDR         : 0x50003900
        GPT_APP TIMER_TTGR         : 0xffffffff
        GPT_APP TIMER_TSICR        : 0x0
        GPT_APP TIMER_TIOCP_CFG    : 0xa
        GPT_APP TIMER_TCLR         : 0x0
        ------------------------------------------
        GPT_APP: Running GPT Test for channel 15
        ------------------------------------------
        GPT_APP: Enabled notification for channel [15]
        GPT_APP: Started Timer Channel [15]
        GPT_APP: Elapsed Time Value = b2612
        GPT_APP: Wait for notification(approx. 6 seconds)
        GPT_APP: GPT Notification received for channel 15 !!!

        GPT_APP: Disable channel notification for this channel
        GPT_APP: Wait till timer overflows, no notification should be received
        GPT_APP: Time Elapsed Value = 0x37284c
        GPT_APP: Time Remaining Value = 0x8ada1c9
        GPT_APP: Waiting for timer to overflow
        GPT_APP: Overflow happened no notification received

        GPT_APP: Stopped for channel 15
        GPT_APP: Enable wakeup for this channel
        GPT_APP: Started timer channel [15]
        GPT_APP: check if this channel is wakeup source for any wakeup event
        EcuM : Wakeup event received for wakeupSource =0 !!!
        GPT_APP: Woken up for channel [15]
        GPT_APP: Stop timer
        GPT_APP: GPT example passed for channel =15 !!!

        GPT_APP------------------------------------------
        GPT_APP: GPT Channel 17 configuration register values  
        GPT_APP TIMER_TIDR         : 0x50003900
        GPT_APP TIMER_TTGR         : 0xffffffff
        GPT_APP TIMER_TSICR        : 0x0
        GPT_APP TIMER_TIOCP_CFG    : 0xa
        GPT_APP TIMER_TCLR         : 0x0
        ------------------------------------------
        GPT_APP: Running GPT Test for channel 17
        ------------------------------------------
        GPT_APP: Enabled notification for channel [17]
        GPT_APP: Started Timer Channel [17]
        GPT_APP: Elapsed Time Value = b2612
        GPT_APP: Wait for notification(approx. 6 seconds)
        GPT_APP: GPT Notification received for channel 18 !!!

        GPT_APP: Disable channel notification for this channel
        GPT_APP: Wait till timer overflows, no notification should be received
        GPT_APP: Time Elapsed Value = 0x372831
        GPT_APP: Time Remaining Value = 0x8ada1e4
        GPT_APP: Waiting for timer to overflow
        GPT_APP: Overflow happened no notification received

        GPT_APP: Stopped for channel 17
        GPT_APP: Enable wakeup for this channel
        GPT_APP: Started timer channel [17]
        GPT_APP: check if this channel is wakeup source for any wakeup event
        EcuM : Wakeup event received for wakeupSource =0 !!!
        GPT_APP: Woken up for channel [17]
        GPT_APP: Stop timer
        GPT_APP: GPT example passed for channel =17 !!!
        GPT_APP: GPT example Completed !!!
        GPT_APP: GPT Stack Usage 2924 bytes
        GPT_APP: GPT Test Passed!!!</pre><p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_ref_top"></a>
References</h1>
<ul>
<li><a class="el" href="design_gpt_top.html">Design Page</a></li>
<li><a href="https://www.autosar.org/fileadmin/user_upload/standards/classic/4-3/AUTOSAR_SWS_GPTDriver.pdf">AUTOSAR Spec : Internal Link</a></li>
</ul>
<p><a class="el" href="ug_gpt_top.html#ug_gpt_intro">Back To Top</a></p>
<hr/>
 <h1><a class="anchor" id="ug_gpt_rev_hist"></a>
Document Revision History</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Revision  </th><th class="markdownTableHeadNone">Date  </th><th class="markdownTableHeadNone">Author  </th><th class="markdownTableHeadNone">Description  </th><th class="markdownTableHeadNone">Status   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.1  </td><td class="markdownTableBodyNone">26 Sep 2018  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">First version  </td><td class="markdownTableBodyNone">Pending Review   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.2  </td><td class="markdownTableBodyNone">11 Oct 2018  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Addressed review comments  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.3  </td><td class="markdownTableBodyNone">16 Oct 2018  </td><td class="markdownTableBodyNone">Sujith S  </td><td class="markdownTableBodyNone">Added Logs from J721E testing  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.4  </td><td class="markdownTableBodyNone">19 Jan 2020  </td><td class="markdownTableBodyNone">Sunil M S  </td><td class="markdownTableBodyNone">Updates w.r.o porting AUTOSAR 4.3.1 Version  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.5  </td><td class="markdownTableBodyNone">02 Nov 2020  </td><td class="markdownTableBodyNone">Nikki S  </td><td class="markdownTableBodyNone">J7200 updated  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.6  </td><td class="markdownTableBodyNone">17 Mar 2022  </td><td class="markdownTableBodyNone">Rohit T  </td><td class="markdownTableBodyNone">Removed J721E &amp; J7200 specific contents  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.7  </td><td class="markdownTableBodyNone">08 Dec 2022  </td><td class="markdownTableBodyNone">Subham Swain  </td><td class="markdownTableBodyNone">Adding J721s2 specific content  </td><td class="markdownTableBodyNone">Approved   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.8  </td><td class="markdownTableBodyNone">10 April 2023  </td><td class="markdownTableBodyNone">Rohit T  </td><td class="markdownTableBodyNone">Fixed doxygen warnings  </td><td class="markdownTableBodyNone">Approved   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mcal_ug_top.html">MCAL Module User Guide</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
