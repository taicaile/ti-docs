

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9.8. Using Processor SDK Linux with Processor SDK RTOS &mdash; Processor SDK RTOS J721S2</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Processor SDK RTOS J721S2" href="index.html"/>
        <link rel="up" title="9. Developer Notes" href="developer_notes.html"/>
        <link rel="next" title="9.9. Understanding and updating SDK memory map for J721S2" href="developer_notes_memory_map.html"/>
        <link rel="prev" title="9.7. Developing with High Security Devices" href="developer_notes_security_build.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Processor SDK RTOS J721S2
          

          
          </a>

          
            
            
              <div class="version">
                09_00_01
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_j721s2.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="firmware_builder.html">3. AM68A Firmware Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk_components_j721s2.html">4. SDK Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">5. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="evm_setup_j721s2.html">6. EVM Setup for J721S2</a></li>
<li class="toctree-l1"><a class="reference internal" href="ccs_setup_j721s2.html">7. CCS Setup for J721S2</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasheet_sdk_j721s2.html">8. Data Sheet</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="developer_notes.html">9. Developer Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="developer_notes_concerto.html">9.1. Understanding concerto makefile system</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_bootloaders.html">9.2. Understanding bootloaders in Processor SDK J721S2 (RTOS/Linux)</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_mcu1_0_sysfw.html">9.3. MCU1_0 Application Development with SYSFW</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_ipc.html">9.4. Developing IPC applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_enet_j721s2.html">9.5. Developing Ethernet based applications with Linux + RTOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_cptracer.html">9.6. System Traffic Profiling using CPTracer on J7</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_security_build.html">9.7. Developing with High Security Devices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9.8. Using Processor SDK Linux with Processor SDK RTOS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">9.8.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-psdk-linux">9.8.2. Setup PSDK LINUX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-r5f-spl-a72-spl-and-a72-u-boot">9.8.3. Build R5F SPL, A72 SPL and A72 u-boot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-linux-dtb-and-dtbo">9.8.4. Build Linux DTB and DTBO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-linux-kernel-and-kernel-modules">9.8.5. Build Linux kernel and kernel modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-steps-to-use-hs-devices">9.8.6. Additional Steps to use HS Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-rebuild-using-further-customizations">9.8.7. Optional : Rebuild Using Further Customizations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_memory_map.html">9.9. Understanding and updating SDK memory map for J721S2</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_tidl.html">9.10. Developing deep learning applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_hwa.html">9.11. Developing HW accelerator applications with OpenVX</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_image_sensor.html">9.12. Adding new image sensor to PSDK RTOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_ddr_inline_ecc.html">9.13. Enabling TI’s inline ECC for DDR</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_display_resolution.html">9.14. Changing Display Resolution in Vision Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_dma_kernel.html">9.15. Enabled block-based memory access in OpenVX kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_dmpac.html">9.16. Running SDE and DOF for 2M-Pixel Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_migration_guide.html">9.17. SDK 8.6 -&gt; SDK 9.0 Migration Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="developer_notes_tda4_latest_faqs.html">9.18. Latest FAQs on TDA4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documentation_tarball.html">10. Documentation Tarball</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Processor SDK RTOS J721S2</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="developer_notes.html"><span class="section-number">9. </span>Developer Notes</a> &raquo;</li>
      
    <li><span class="section-number">9.8. </span>Using Processor SDK Linux with Processor SDK RTOS</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-processor-sdk-linux-with-processor-sdk-rtos">
<span id="psdkl-with-psdkr"></span><h1><span class="section-number">9.8. </span>Using Processor SDK Linux with Processor SDK RTOS<a class="headerlink" href="#using-processor-sdk-linux-with-processor-sdk-rtos" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">9.8.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Processor SDK Linux J721S2 (PSDK LINUX) and Processor SDK RTOS J721S2 (PSDK RTOS) work together to
realize use-cases on the J721S2 platform. In most cases using the pre-built linux filesystem, kernel, bootloader
is sufficient to build different usecases. However sometimes it is needed to rebuild certain parts of
PSDK LINUX to update things like bootloader, SYSFW configuration, kernel dtb/dtbo and so on.</p>
<p>This page shows quick steps to rebuild and update below,</p>
<ul class="simple">
<li><p>R5F SPL, A72 SPL, A72 uboot (tiboot3.bin, tispl.bin, u-boot.img)</p></li>
<li><p>SYSFW configuration (sysfw.itb)</p></li>
<li><p>Linux kernel .dtb’s and .dtbo’s ( /boot/*.dtb, /boot/*.dtbo)</p></li>
<li><p>Linux kernel and kernel modules ( /boot/Image, /lib/modules/*)</p></li>
</ul>
<p>The below instructions also include details about building for HS devices.  The prebuilt binaries included
with the Linux SDK are for GP devices, so the HS binaries will need to be built using the instructions below
in order to run on HS.  Specifically, the u-boot binaries and the fitImage will need to be built
for HS and installed onto the SD card as shown in the sections below.</p>
<p>More detailed instruction to build PSDK LINUX are given in PSDK LINUX user guide.
Refer ${PSDK_LINUX_PATH}//docs/linux/index.html for more details.</p>
</div>
<div class="section" id="setup-psdk-linux">
<h2><span class="section-number">9.8.2. </span>Setup PSDK LINUX<a class="headerlink" href="#setup-psdk-linux" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Download the PSDK LINUX installer and install as shown below</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="n">ti</span><span class="o">-</span><span class="n">processor</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">linux</span><span class="o">-&lt;</span><span class="n">soc</span><span class="o">&gt;-</span><span class="n">evm</span><span class="o">-</span><span class="n">xx_xx_xx</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="n">Install</span><span class="p">.</span><span class="n">bin</span>
<span class="p">.</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">processor</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">linux</span><span class="o">-&lt;</span><span class="n">soc</span><span class="o">&gt;-</span><span class="n">evm</span><span class="o">-</span><span class="n">xx_xx_xx</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="n">Install</span><span class="p">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>Edit below files to adjust some paths and variables needed to build SYSFW config, uboot, kernel, dtb’s</p>
<blockquote>
<div><ol class="arabic">
<li><p>Edit below in ${PSDK_LINUX_PATH}/Rules.make to point to the root filesystem and the boot partition in SD card</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#root of the target file system for installing kernel Image, dtb&#39;s and modules</span>
<span class="n">DESTDIR</span><span class="w"> </span><span class="o">?=/</span><span class="n">media</span><span class="o">/&lt;</span><span class="n">user</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;/</span><span class="n">rootfs</span>

<span class="cp">#Location of the boot partition for installing boot binaries/images</span>
<span class="n">BOOTFS</span><span class="w"> </span><span class="o">?=/</span><span class="n">media</span><span class="o">/&lt;</span><span class="n">user</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;/</span><span class="n">BOOT</span>
</pre></div>
</div>
</li>
<li><p>Update below in ${PSDK_LINUX_PATH}/Rules.make to choose the device type to build for.
The Makefile will build for a General Purpose (GP) device by default.
Please refer to the note below for additional steps to boot a High Secure (HS) device type</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#SOC_TYPE : Choose between gp, hs, hs-fs</span>
<span class="n">SOC_TYPE</span><span class="w"> </span><span class="o">?=</span><span class="w"> </span><span class="n">gp</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Using prebuilt images of ATF (Arm Trusted Firmware), OPTEE (Open Portable Trusted Execution Environment), and MCU1_0 (Micro Controller Unit),
we can now quickly build the SYSFW configuration, bootloader and kernel</p></li>
</ul>
</div>
<div class="section" id="build-r5f-spl-a72-spl-and-a72-u-boot">
<h2><span class="section-number">9.8.3. </span>Build R5F SPL, A72 SPL and A72 u-boot<a class="headerlink" href="#build-r5f-spl-a72-spl-and-a72-u-boot" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>R5F SPL, A72 SPL and A72 u-boot can be found below</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span><span class="o">-*</span>
</pre></div>
</div>
</li>
<li><p>Do below at ${PSDK_LINUX_PATH}/ to build R5F SPL, A72 SPL and A72 u-boot</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="n">u</span><span class="o">-</span><span class="n">boot</span>
</pre></div>
</div>
</li>
<li><p>After successful build, Install files to ‘BOOT’ partition in the SD card using</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="n">u</span><span class="o">-</span><span class="n">boot_install</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p><strong>Note</strong>: The u-boot build and install targets also trigger the makefile
targets to build and install the combined tiboot3.bin</p></li>
<li><p>Using the above, the following files will be copied to the ‘BOOT’ partition.
These files will be generated at the location regardless of whether it is
build for gp, hs or hs-fs</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">built</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">tiboot3</span><span class="p">.</span><span class="n">bin</span>
<span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">built</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">tispl</span><span class="p">.</span><span class="n">bin</span>
<span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">built</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span><span class="p">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="build-linux-dtb-and-dtbo">
<h2><span class="section-number">9.8.4. </span>Build Linux DTB and DTBO<a class="headerlink" href="#build-linux-dtb-and-dtbo" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>The linux kernel input dts, dtso and generated dtb, dtbo are located below</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">linux</span><span class="o">-*/</span><span class="n">arch</span><span class="o">/</span><span class="n">arm64</span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">dts</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>Do below at ${PSDK_LINUX_PATH}/ to regenerate the linux kernel .dtb, dtbo files</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="n">linux</span><span class="o">-</span><span class="n">dtbs</span>
</pre></div>
</div>
</li>
<li><p>Do below at ${PSDK_LINUX_PATH}/ to copy the updated .dtb, dtbo files to SD card</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">linux</span><span class="o">-</span><span class="n">dtbs_install</span><span class="p">;</span><span class="n">sync</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="build-linux-kernel-and-kernel-modules">
<h2><span class="section-number">9.8.5. </span>Build Linux kernel and kernel modules<a class="headerlink" href="#build-linux-kernel-and-kernel-modules" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Linux kernel can be found below</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">linux</span><span class="o">-*</span>
</pre></div>
</div>
</li>
<li><p>Do below at ${PSDK_LINUX_PATH}/ to rebuild the linux kernel and kernel modules</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="n">linux</span>
</pre></div>
</div>
</li>
<li><p>Do below at ${PSDK_LINUX_PATH}/ to copy the updated linux kernel and kernel modules to SD card</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">linux_install</span><span class="p">;</span><span class="n">sync</span>
</pre></div>
</div>
</li>
<li><p>HS devices require a fitImage to be installed in the SD card, that packages the signed Kernel Image and dtbs.
When building for HS devices (SOC_TYPE=&lt;hs/hs-fs&gt;), the above install command will generate a fitImage at
<code class="docutils literal notranslate"><span class="pre">${PSDK_LINUX_PATH}/board-support/built-images/</span></code> and install the same to the SD card.</p></li>
</ul>
</div>
<div class="section" id="additional-steps-to-use-hs-devices">
<h2><span class="section-number">9.8.6. </span>Additional Steps to use HS Devices<a class="headerlink" href="#additional-steps-to-use-hs-devices" title="Permalink to this headline">¶</a></h2>
<p>As described above, The SOC_TYPE variable in Rules.make defines what device type to build for. Below is a short description for each</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>SOC_TYPE=gp                     # For a GP device (default)
SOC_TYPE=hs                     # For a HS-SE device
SOC_TYPE=hs-fs                  # For a HS-FS device
</pre></div>
</div>
<p>After setting the SOC_TYPE variable appropriately and installing all of the above components,
some additional steps may be needed for HS devices (Both HS-SE and HS-FS):</p>
<ul>
<li><p>Set the environment variable TI_SECURE_DEV_PKG to TI security development tools package, included in the Linux SDK</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="n">TI_SECURE_DEV_PKG</span><span class="o">=</span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">core</span><span class="o">-</span><span class="n">secdev</span><span class="o">-</span><span class="n">k3</span>
<span class="n">ROOTFS</span><span class="o">=/</span><span class="n">media</span><span class="o">/</span><span class="n">$USER</span><span class="o">/</span><span class="n">rootfs</span>
</pre></div>
</div>
</li>
<li><p>Signing the remote core firmwares: The remote core firmware binaries at /lib/firmware in the target filesystem need to be signed. For instance:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$TI_SECURE_DEV_PKG</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">secure</span><span class="o">-</span><span class="n">binary</span><span class="o">-</span><span class="n">image</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">ROOTFS</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">firmware</span><span class="o">/</span><span class="n">pdk</span><span class="o">-</span><span class="n">ipc</span><span class="o">/</span><span class="n">ipc_echo_test_mcu2_0_release_strip</span><span class="p">.</span><span class="n">xer5f</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">ROOTFS</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">firmware</span><span class="o">/</span><span class="n">pdk</span><span class="o">-</span><span class="n">ipc</span><span class="o">/</span><span class="n">ipc_echo_test_mcu2_0_release_strip</span><span class="p">.</span><span class="n">xer5f</span><span class="p">.</span><span class="kt">signed</span>
</pre></div>
</div>
</li>
<li><p>Softlinks to point to signed remote core firmwares: u-boot will look for <code class="docutils literal notranslate"><span class="pre">-sec</span></code> suffixed softlinks to the signed remote core binaries</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">sfn</span><span class="w"> </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">firmware</span><span class="o">/</span><span class="n">pdk</span><span class="o">-</span><span class="n">ipc</span><span class="o">/</span><span class="n">ipc_echo_test_mcu2_0_release_strip</span><span class="p">.</span><span class="n">xer5f</span><span class="p">.</span><span class="kt">signed</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">ROOTFS</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">firmware</span><span class="o">/</span><span class="n">j7</span><span class="o">-</span><span class="n">main</span><span class="o">-</span><span class="n">r5f0_0</span><span class="o">-</span><span class="n">fw</span><span class="o">-</span><span class="n">sec</span>
</pre></div>
</div>
</li>
</ul>
<p>If using vision apps, the built firmware can be signed and installed using a single command as shown below.  For more information,
please reference the vision apps documentation.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span><span class="w"> </span><span class="n">linux_fs_install_sd</span><span class="w"> </span><span class="n">HS</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="optional-rebuild-using-further-customizations">
<h2><span class="section-number">9.8.7. </span>Optional : Rebuild Using Further Customizations<a class="headerlink" href="#optional-rebuild-using-further-customizations" title="Permalink to this headline">¶</a></h2>
<p><strong>Using custom ATF/OPTEE/MCU1_0 images for u-boot</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">u-boot</span></code> command picks up ATF, OPTEE and MCU1_0 Images from the locations shown below.
If using custom binaries for these, replace the original one based on the device type being used.</p>
<ul>
<li><p>For GP devices (<code class="docutils literal notranslate"><span class="pre">SOC_TYPE=gp</span></code>), these locations are used</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>${PSDK_LINUX_PATH}/board-support/prebuilt-images/bl31.bin                                       # ATF
${PSDK_LINUX_PATH}/board-support/prebuilt-images/bl32.bin                                       # OPTEE
${PSDK_LINUX_PATH}/board-support/prebuilt-images/ipc_echo_testb_mcu1_0_release_strip.xer5f      # MCU1_0 DM image
</pre></div>
</div>
</li>
<li><p>For HS devices (<code class="docutils literal notranslate"><span class="pre">SOC_TYPE=&lt;hs/hs-fs&gt;</span></code>), these binaries need to be signed as well.
For instance, the bl31.bin can be signed by running the below command</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$TI_SECURE_DEV_PKG</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">secure</span><span class="o">-</span><span class="n">binary</span><span class="o">-</span><span class="n">image</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">bl31</span><span class="p">.</span><span class="n">bin</span><span class="w"> </span><span class="n">bl31</span><span class="p">.</span><span class="n">bin</span><span class="p">.</span><span class="kt">signed</span>
</pre></div>
</div>
<p>Place the custom-built and signed binaries at below locations.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>${PSDK_LINUX_PATH}/board-support/prebuilt-images/bl31.bin.signed                                    # ATF
${PSDK_LINUX_PATH}/board-support/prebuilt-images/bl32.bin.signed                                    # OPTEE
${PSDK_LINUX_PATH}/board-support/prebuilt-images/ipc_echo_testb_mcu1_0_release_strip.xer5f.signed   # MCU1_0 DM image
</pre></div>
</div>
</li>
</ul>
<p>After updating the above files at the corresponding locations, u-boot can be rebuilt and installed using the same steps.</p>
<p><strong>SYSFW Binaries</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">u-boot</span></code> command picks up the sysfw binaries from the locations shown below.
To build with a new SYSFW binary, replace the original one based on the device type being used.</p>
<ul>
<li><p>For GP devices (<code class="docutils literal notranslate"><span class="pre">SOC_TYPE=gp</span></code>), the SYSFW binaries are located at the below path</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">firmware</span><span class="o">-*-</span><span class="n">gp</span><span class="p">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>For HS-SE devices (<code class="docutils literal notranslate"><span class="pre">SOC_TYPE=hs</span></code>), the SYSFW binaries are located at the below path</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">firmware</span><span class="o">-*-</span><span class="n">hs</span><span class="o">-</span><span class="n">cert</span><span class="p">.</span><span class="n">bin</span>
<span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">firmware</span><span class="o">-*-</span><span class="n">hs</span><span class="o">-</span><span class="n">enc</span><span class="p">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>For HS-FS devices (<code class="docutils literal notranslate"><span class="pre">SOC_TYPE=hs-fs</span></code>), the SYSFW binaries are located at the below path</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">firmware</span><span class="o">-*-</span><span class="n">hs</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">cert</span><span class="p">.</span><span class="n">bin</span>
<span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">firmware</span><span class="o">-*-</span><span class="n">hs</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">enc</span><span class="p">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
</ul>
<p>After updating the above files at the corresponding locations, sysfw-image can be rebuilt and installed using the same steps.</p>
<p><strong>Customizing fitImage for HS Devices</strong></p>
<p>A prebuilt fitImage is included in the prebuilt-images of the PSDK Linux. Install this using the command shown below</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">fitImage</span><span class="w"> </span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">$</span><span class="p">(</span><span class="n">USER</span><span class="p">)</span><span class="o">/</span><span class="n">rootfs</span><span class="o">/</span><span class="n">boot</span><span class="o">/</span>
</pre></div>
</div>
<p>To build the Linux fitImage for HS devices using a custom fitImage configuration, modify the file shown below required</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="p">{</span><span class="n">PSDK_LINUX_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">prebuilt</span><span class="o">-</span><span class="n">images</span><span class="o">/</span><span class="n">fitImage</span><span class="p">.</span><span class="n">its</span>
</pre></div>
</div>
<ul>
<li><p>If the Kernel Image and dtbs do not need an update, prebuilt-images for the same are packaged at <code class="docutils literal notranslate"><span class="pre">${PSDK_LINUX_PATH}/board-support/prebuilt-images/</span></code>.
To build and install a fitImage using the modified fitImage.its, run below commands from this location</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mkimage</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">fitImage</span><span class="p">.</span><span class="n">its</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">fitImage</span>
<span class="n">sudo</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">fitImage</span><span class="w"> </span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">$</span><span class="p">(</span><span class="n">USER</span><span class="p">)</span><span class="o">/</span><span class="n">rootfs</span><span class="o">/</span><span class="n">boot</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>If the Kernel Image or dtbs need to be updated as well, after modifying the fitImage.its, simply run the command below
to build and install a fitImage using newly built Kernel Image, dtbs and the modified fitImage.its</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span><span class="w"> </span><span class="n">SOC_TYPE</span><span class="o">=</span><span class="n">hs</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">linux_install</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="developer_notes_memory_map.html" class="btn btn-neutral float-right" title="9.9. Understanding and updating SDK memory map for J721S2" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="developer_notes_security_build.html" class="btn btn-neutral" title="9.7. Developing with High Security Devices" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2022</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });
      });
  </script>
   

</body>
</html>