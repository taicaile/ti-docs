<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TI Autonomous Driving Algorithms (TIADALG) Library User Guide: TIADALG : Parking Spot Design</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TI Autonomous Driving Algorithms (TIADALG) Library User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_docs_doxygen_design_doc_pages_content_pages_03000_tiadalg_psd_design.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TIADALG : Parking Spot Design </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#did_tiadalg_psd_intro">Introduction</a><ul><li class="level2"><a href="#did_tiadalg_psd_purpose">Purpose</a></li>
<li class="level2"><a href="#did_tiadalg_psd_short_desc">Short Application Description</a></li>
<li class="level2"><a href="#did_tiadalg_psd_io_format">Input and Output format</a></li>
</ul>
</li>
<li class="level1"><a href="#did_tiadalg_psd_dir_structure">Directory Structure</a></li>
<li class="level1"><a href="#did_tiadalg_psd_diagrams">Diagrams</a><ul><li class="level2"><a href="#did_tiadalg_psd_sequence_diagram">Sequence Diagram</a></li>
<li class="level2"><a href="#did_tiadalg_psd_component_interaction">Component Interaction</a></li>
<li class="level2"><a href="#did_tiadalg_psd_openvx_graph">OpenVX Graph</a></li>
</ul>
</li>
<li class="level1"><a href="#did_tiadalg_psd_resource_usage">Resource usage</a></li>
<li class="level1"><a href="#did_tiadalg_psd_error_handling">Error handling</a></li>
<li class="level1"><a href="#did_tiadalg_psd_interface">Interface</a></li>
<li class="level1"><a href="#did_tiadalg_psd_dar">Design Analysis and Resolution (DAR)</a><ul><li class="level2"><a href="#did_tiadalg_psd_dar_01">Design Decision : none</a><ul><li class="level3"><a href="#did_tiadalg_psd_dar_01_criteria">Design Criteria: none</a></li>
<li class="level3"><a href="#did_tiadalg_psd_dar_01_alt_01">Design Alternative: none</a></li>
<li class="level3"><a href="#did_tiadalg_psd_dar_01_alt_02">Design Alternative: none</a></li>
<li class="level3"><a href="#did_tiadalg_psd_dar_01_decision">Final Decision</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1>Requirements Addressed {#did_TIADALG parking spot requirements}</h1>
<ul>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-166">https://jira.itg.ti.com/browse/ADASALGOS-166</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-167">https://jira.itg.ti.com/browse/ADASALGOS-167</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-146">https://jira.itg.ti.com/browse/ADASALGOS-146</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-106">https://jira.itg.ti.com/browse/ADASALGOS-106</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-105">https://jira.itg.ti.com/browse/ADASALGOS-105</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-104">https://jira.itg.ti.com/browse/ADASALGOS-104</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-103">https://jira.itg.ti.com/browse/ADASALGOS-103</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-102">https://jira.itg.ti.com/browse/ADASALGOS-102</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-101">https://jira.itg.ti.com/browse/ADASALGOS-101</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-100">https://jira.itg.ti.com/browse/ADASALGOS-100</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-99">https://jira.itg.ti.com/browse/ADASALGOS-99</a></li>
<li><a href="https://jira.itg.ti.com/browse/ADASALGOS-98">https://jira.itg.ti.com/browse/ADASALGOS-98</a></li>
</ul>
<h1><a class="anchor" id="did_tiadalg_psd_intro"></a>
Introduction</h1>
<h2><a class="anchor" id="did_tiadalg_psd_purpose"></a>
Purpose</h2>
<p>Auto Valet Parking is important step towards achieving highly automated driving solutions. Parking Spot detection and classification is key building block for achieving that. Most of the deep-learning (CNN) solutions are based on rectilinear images (not fish eye images). Conventional object-detection algorithms works for rectangular objects, whereas parking spots are not rectilinear and so it is even more difficult in fish eye image.</p>
<div class="image">
<img src="images/tiadalg_psd_1.png" title="parking spot challenges in fish eye images"/>
</div>
<h2><a class="anchor" id="did_tiadalg_psd_short_desc"></a>
Short Application Description</h2>
<p>Deep learning based Object Detections are designed to predict boxes (TL,W,H). Algorithm design is to enhance object detect algorithm to work for parking spot detection. We define predicted vector for each parking spot as follows. Pv = [ P0_x, P0_y, P1_x, P1_y, P2_x, P2_y, P3_x, P3_y, TL_x, TL_y, W, H ]. Though parameters (TL_x, TL_y, W, H) are not needed to be predicted in this task, we have designed to use it for the following reasons, Ground truth matching while training. Anchor concept used in the box case is not practical for parking spot detect task as huge numbers of anchor shapes will be needed to comprehend different parking spot shapes due to perspective and fisheye effect. We propose to use virtual bounding box that is defined as minimum rectangle area (with sides parallel to image plane) containing key points on its edges. For ground truth matching now instead of key points overlap we check virtual box overlap with GT virtual box. Loss minimization: In the location loss along with key point error we use virtual box location error too.</p>
<div class="image">
<img src="images/tiadalg_psd_2.png" title="Parking Spot Detection"/>
</div>
<p>These four points along with camera intrinsic parameters can be used to precisely locate the parking spot in fish eye image domain. Steps for converting 4 point detection into pixel wise detection.</p><ul>
<li>Transform 4 detected key points into fish eye corrected image domain</li>
<li>Interpolate intermediate points on all four lines in fish eye corrected image domain</li>
<li>Transform back original and interpolated points back to fish eye image domain</li>
</ul>
<div class="image">
<img src="images/tiadalg_psd_3.png" title="Pixel wise mask generation from 4 keypoints"/>
</div>
<p>Same technique is used for annotating the ground truth, only four corner points are annotated for fast annotation process Order of key point is maintained while annotation for all parking spots. First two key points are always from entry of the parking spot.</p>
<h2><a class="anchor" id="did_tiadalg_psd_io_format"></a>
Input and Output format</h2>
<ul>
<li>Input data is provided as 3 planes of BGR images</li>
<li>Input pixels are assumed to be 8 bit at TIDL interface</li>
<li>TIDL gives out list of objects with bounding box information and associated 4 keypoints for each box</li>
<li>4 key points are converted into pixel mask as discussed above</li>
</ul>
<h1><a class="anchor" id="did_tiadalg_psd_dir_structure"></a>
Directory Structure</h1>
<h1><a class="anchor" id="did_tiadalg_psd_diagrams"></a>
Diagrams</h1>
<h2><a class="anchor" id="did_tiadalg_psd_sequence_diagram"></a>
Sequence Diagram</h2>
<h2><a class="anchor" id="did_tiadalg_psd_component_interaction"></a>
Component Interaction</h2>
<h2><a class="anchor" id="did_tiadalg_psd_openvx_graph"></a>
OpenVX Graph</h2>
<div class="image">
<img src="vx_app_tidl_psd_data_flow.jpg"/>
</div>
<h1><a class="anchor" id="did_tiadalg_psd_resource_usage"></a>
Resource usage</h1>
<h1><a class="anchor" id="did_tiadalg_psd_error_handling"></a>
Error handling</h1>
<h1><a class="anchor" id="did_tiadalg_psd_interface"></a>
Interface</h1>
<p>Following configuration options will be supported in the configuration <a href="file::">file::</a></p>
<h1><a class="anchor" id="did_tiadalg_psd_dar"></a>
Design Analysis and Resolution (DAR)</h1>
<h2><a class="anchor" id="did_tiadalg_psd_dar_01"></a>
Design Decision : none</h2>
<p>na</p>
<h3><a class="anchor" id="did_tiadalg_psd_dar_01_criteria"></a>
Design Criteria: none</h3>
<p>na</p>
<h3><a class="anchor" id="did_tiadalg_psd_dar_01_alt_01"></a>
Design Alternative: none</h3>
<p>na</p>
<h3><a class="anchor" id="did_tiadalg_psd_dar_01_alt_02"></a>
Design Alternative: none</h3>
<p>na</p>
<h3><a class="anchor" id="did_tiadalg_psd_dar_01_decision"></a>
Final Decision</h3>
<p>na </p>
</div></div><!-- contents -->
</div><!-- doc-content -->

<html>
<table bordercolor="#FFFFFF" bgcolor="#FFFFFF" width="100%">
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF">
        <hr align="left" noshade size="1">
      </td>
</tr>
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#000000"><b><i>
        &copy Copyright 2018 Texas Instruments Incorporated. All rights reserved. </i></b></font></td>
</tr>
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#000000">
        Document generated by <b><i> doxygen </i></b> 1.8.6
  </font></td>
</tr>
</table>
