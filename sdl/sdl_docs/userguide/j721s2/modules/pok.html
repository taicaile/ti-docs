

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.7. POK: Power OK &mdash; Software Diagnostics Library (SDL) - J721S2 User Guide</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Software Diagnostics Library (SDL) - J721S2 User Guide" href="../index.html"/>
        <link rel="up" title="4. Modules" href="../family_cfg/j721s2/index_modules_j721s2.html"/>
        <link rel="next" title="4.8. TOG : Time-Out Gasket" href="tog.html"/>
        <link rel="prev" title="4.6. RTI : RTI/WWDT Windowed Watchdog Timer" href="rti.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="../_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index_j721s2.html" class="icon icon-home"> Software Diagnostics Library (SDL) - J721S2 User Guide
          

          
          </a>

          
            
            
              <div class="version">
                01_01_00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_release_notes_j721s2.html">2. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">3. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../family_cfg/j721s2/index_modules_j721s2.html">4. Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="esm.html">4.1. ESM : Error Signalling Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecc.html">4.2. ECC : Error Correcting Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbist.html">4.3. PBIST : Memory Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="lbist.html">4.4. LBIST : Logic Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtm.html">4.5. VTM : Voltage and Thermal Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="rti.html">4.6. RTI : RTI/WWDT Windowed Watchdog Timer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.7. POK: Power OK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">4.7.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">4.7.2. Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">4.7.3. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">4.7.4. API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tog.html">4.8. TOG : Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtog.html">4.9. MTOG : Master Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcc.html">4.10. DCC : Dual Clock Comparator</a></li>
<li class="toctree-l2"><a class="reference internal" href="mcrc.html">4.11. MCRC : Cyclic Redundancy Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="r5fccm.html">4.12. R5F CCM: CPU Compare Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="osal.html">4.13. OSAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="r5.html">4.14. R5 Core Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rom_checksum.html">4.15. ROM_CHECKSUM: ROM Checksum Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_examples_j721s2.html">5. Safety Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diagnostic_mappings.html">6. Diagnostic Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_application_notes_j721s2.html">7. Developer Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_j721s2.html">Software Diagnostics Library (SDL) - J721S2 User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_j721s2.html">Docs</a> &raquo;</li>
      
          <li><a href="../family_cfg/j721s2/index_modules_j721s2.html"><span class="section-number">4. </span>Modules</a> &raquo;</li>
      
    <li><span class="section-number">4.7. </span>POK: Power OK</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="pok-power-ok">
<h1><span class="section-number">4.7. </span>POK: Power OK<a class="headerlink" href="#pok-power-ok" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2><span class="section-number">4.7.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This device has several internal voltage monitors called Power OK (POK). These monitors can be configured to detect undervoltage (UV) or overvoltage (OV) conditions, and to report errors via ESM.
SDL provides the support for programming of the POK modules, including the internal POKs for the POR module. The threshold limits can be configured, and the POK monitoring enabled. Programming is generally done at init time. All POK modules are in the wakeup domain.</p>
<p>POK modules are responsible for monitoring and accurately detecting voltage levels. POK modules are capable of monitoring a range of supplies and indicating a failure within the programmable upper and lower threshold limits for the supply being monitored. POKs are used to monitor voltage supply levels with programmable threshold levels. As an example, the POK programmable threshold resolution is 12.5mV for the threshold setting range from 0.475V to 1.35V for under voltage protection.</p>
<p>This module provides the following functionality:</p>
<ul class="simple">
<li><p>Ability to initialize a POK</p></li>
<li><p>Ability to verify written POK configuration</p></li>
<li><p>Ability to readback of written configuration</p></li>
</ul>
<p>There are 10 POK instances in j721s2. Additionally, there are 3 POK modules in POR.</p>
</section>
<section id="example-usage">
<h2><span class="section-number">4.7.2. </span>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>The following shows an example of SDL POK API usage by the application to set up the POK and usage of the POK APIs. Events can be monitored by enabling the events in the associated ESM instance.</p>
<p>Initialize a POK Instance</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>int32_t<span class="w"> </span>sdlRet<span class="p">;</span>
SDL_POK_config<span class="w"> </span>pokCfg<span class="p">;</span>
SDL_POK_Inst<span class="w"> </span>instance<span class="p">;</span>

<span class="nv">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_POR_POKHV_OV_ID<span class="p">;</span>
pPokCfg.voltDetMode<span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_PWRSS_SET_OVER_VOLTAGE_DET_ENABLE<span class="p">;</span>
pPokCfg.trim<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>//<span class="w"> </span>Configure<span class="w"> </span>the<span class="w"> </span>OV<span class="w"> </span><span class="o">(</span>Over<span class="w"> </span>voltage<span class="o">)</span><span class="w"> </span>POK<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>small<span class="w"> </span>value<span class="w"> </span>to<span class="w"> </span>force<span class="w"> </span>an<span class="w"> </span>error
<span class="w">                  </span>//<span class="w"> </span>Alternatively,<span class="w"> </span>can<span class="w"> </span>provide<span class="w"> </span>a<span class="w"> </span>good<span class="w"> </span>value

<span class="nv">sdlRet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_POK_init<span class="o">(</span>instance,<span class="w"> </span><span class="p">&amp;</span>pokCfg<span class="o">)</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="o">(</span>sdlRet<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>SDL_PASS<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;SDL_POK_init failed! \n&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>

/*<span class="w"> </span>If<span class="w"> </span>ESM<span class="w"> </span>event<span class="w"> </span>comes,<span class="w"> </span><span class="k">then</span><span class="w"> </span>Over<span class="w"> </span>voltage<span class="w"> </span>condition<span class="w"> </span>is<span class="w"> </span>reached<span class="w"> </span>*/
</pre></div>
</div>
</div></blockquote>
<p>Verify the Written Config (can be called after SDL_POK_init)</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>int32_t<span class="w"> </span>ret<span class="p">;</span>

/*<span class="w"> </span>Pass<span class="w"> </span>the<span class="w"> </span>expected<span class="w"> </span>config<span class="w"> </span>*/
<span class="nv">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_POK_verifyConfig<span class="o">(</span>instance,<span class="w"> </span><span class="p">&amp;</span>pokCfg<span class="o">)</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="o">(</span>ret<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>SDL_Pass<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span>//<span class="w"> </span>verification<span class="w"> </span>failed
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Read back the Static Registers</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>int32_t<span class="w"> </span>ret<span class="p">;</span>
SDL_POK_staticRegs<span class="w"> </span>staticRegs<span class="p">;</span>

<span class="nv">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_POK_getStaticRegisters<span class="o">(</span>instance,<span class="w"> </span><span class="p">&amp;</span>staticRegs<span class="o">)</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="o">(</span>ret<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>SDL_PASS<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span>//<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>static<span class="w"> </span>regs
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="examples">
<h2><span class="section-number">4.7.3. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The POK module provide a Safety Example to show how to use POK for injecting an error and checking the error response, and also ESM application callback usage. Details regarding the POK Safety Example can be found <a class="reference external" href="../examples/pok.html">here</a>.</p>
<p>Test apps that are meant for verifying the functionality of the module are also provided.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test App Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Location</p></th>
<th class="head"><p>Build Command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sdl_pok_test_app</p></td>
<td><ul class="simple">
<li><p>Configures each POK instance</p></li>
<li><p>Triggers the error events</p></li>
<li><p>Checks for error response</p></li>
</ul>
</td>
<td><p>[sdl_install_dir]/test/pok/</p></td>
<td><p>make sdl_pok_test_app PROFILE=release</p></td>
</tr>
</tbody>
</table>
</section>
<section id="api">
<h2><span class="section-number">4.7.4. </span>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="../../../apiguide/j721s2/html/group__SDL__POK__API.html">POK API Guide</a></p>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tog.html" class="btn btn-neutral float-right" title="4.8. TOG : Time-Out Gasket" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rti.html" class="btn btn-neutral" title="4.6. RTI : RTI/WWDT Windowed Watchdog Timer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2021</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'01_01_00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });
      });
  </script>
   

</body>
</html>