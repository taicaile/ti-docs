

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.11. MCRC : Cyclic Redundancy Check &mdash; Software Diagnostics Library (SDL) - J721S2 User Guide</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Software Diagnostics Library (SDL) - J721S2 User Guide" href="../index.html"/>
        <link rel="up" title="4. Modules" href="../family_cfg/j721s2/index_modules_j721s2.html"/>
        <link rel="next" title="4.12. R5F CCM: CPU Compare Module" href="r5fccm.html"/>
        <link rel="prev" title="4.10. DCC : Dual Clock Comparator" href="dcc.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="../_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index_j721s2.html" class="icon icon-home"> Software Diagnostics Library (SDL) - J721S2 User Guide
          

          
          </a>

          
            
            
              <div class="version">
                01_01_00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_release_notes_j721s2.html">2. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">3. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../family_cfg/j721s2/index_modules_j721s2.html">4. Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="esm.html">4.1. ESM : Error Signalling Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecc.html">4.2. ECC : Error Correcting Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbist.html">4.3. PBIST : Memory Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="lbist.html">4.4. LBIST : Logic Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtm.html">4.5. VTM : Voltage and Thermal Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="rti.html">4.6. RTI : RTI/WWDT Windowed Watchdog Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="pok.html">4.7. POK: Power OK</a></li>
<li class="toctree-l2"><a class="reference internal" href="tog.html">4.8. TOG : Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtog.html">4.9. MTOG : Master Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcc.html">4.10. DCC : Dual Clock Comparator</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.11. MCRC : Cyclic Redundancy Check</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">4.11.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">4.11.2. Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">4.11.3. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">4.11.4. API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="r5fccm.html">4.12. R5F CCM: CPU Compare Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="osal.html">4.13. OSAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="r5.html">4.14. R5 Core Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rom_checksum.html">4.15. ROM_CHECKSUM: ROM Checksum Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_examples_j721s2.html">5. Safety Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diagnostic_mappings.html">6. Diagnostic Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_application_notes_j721s2.html">7. Developer Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_j721s2.html">Software Diagnostics Library (SDL) - J721S2 User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_j721s2.html">Docs</a> &raquo;</li>
      
          <li><a href="../family_cfg/j721s2/index_modules_j721s2.html"><span class="section-number">4. </span>Modules</a> &raquo;</li>
      
    <li><span class="section-number">4.11. </span>MCRC : Cyclic Redundancy Check</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="mcrc-cyclic-redundancy-check">
<h1><span class="section-number">4.11. </span>MCRC : Cyclic Redundancy Check<a class="headerlink" href="#mcrc-cyclic-redundancy-check" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2><span class="section-number">4.11.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>MCRC module is used to perform CRC (Cyclic Redundancy check) to verify integrity of a memory system. The MCRC controller is used to calculate the signature for a set of data and then compare the calculated signature value against a predetermined good signature value. MCRC controller provides four channels to perform CRC calculation on multiple memories.</p>
<p>Each MCRC instance supports 4 channels. Each channel can be configured to operate in one of 3 modes</p>
<blockquote>
<div><ul class="simple">
<li><p>Auto Mode: In this mode, the MCRC controller, in conjunction with DMA controller, can perform CRC totally without CPU intervention.</p></li>
<li><p>Full Mode: In this mode, the CPU does the data patterns transfer and signature verification all by itself. CPU performs data patterns transfer by reading data from the memory system to the PSA signature register.</p></li>
<li><p>Semi Mode: In this mode, DMA controller is used to perform data patterns transfer and signature verification.</p></li>
</ul>
</div></blockquote>
<p>Timeout is configured to generate timeout interrupt to ensure that the memory system is examined with predefined time frame and no loss of incoming data. A 24-bit counter per CRC channel is configured.</p>
<p>The module supports below API’s for the application</p>
<ul class="simple">
<li><p>API to support and configure Full, Semi, and Auto MCRC mode</p></li>
<li><p>API to support readback of static registers</p></li>
<li><p>API to support readback of written configuration</p></li>
<li><p>API to support interrupt configuration</p></li>
</ul>
<p>MCU_NAVSS_MCRC0 and NAVSS_MCRC0 are supported for J721S2.</p>
</section>
<section id="example-usage">
<h2><span class="section-number">4.11.2. </span>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>The following shows an example of SDL MCRC API usage by the application for Full CPU mode.</p>
<p>Initialize an MCRC instance and channel</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_MCRC_init<span class="o">(</span>MCRC_MCU_NAVSS,<span class="w"> </span>SDL_MCRC_CHANNEL_1,<span class="w"> </span>MCRC_DEF_WATCHDOG_PRELOAD,<span class="w"> </span>MCRC_DEF_BLOCK_PRELOAD<span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>Reset and configure the MCRC channel</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_MCRC_channelReset<span class="o">(</span>MCRC_MCU_NAVSS,<span class="w"> </span>SDL_MCRC_CHANNEL_1<span class="o">)</span><span class="p">;</span>
SDL_MCRC_config<span class="o">(</span>MCRC_MCU_NAVSS,<span class="w"> </span>SDL_MCRC_CHANNEL_1,<span class="w"> </span>MCRC_DEF_PATTERN_COUNT,<span class="w"> </span>MCRC_DEF_SECTOR_COUNT,<span class="w"> </span>SDL_MCRC_OPERATION_MODE_FULLCPU<span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>Verify the configuration:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_MCRC_verifyConfig<span class="o">(</span>MCRC_MCU_NAVSS,<span class="w"> </span>SDL_MCRC_CHANNEL_1,<span class="w"> </span>MCRC_DEF_PATTERN_COUNT,<span class="w"> </span>MCRC_DEF_SECTOR_COUNT,<span class="w"> </span>SDL_MCRC_OPERATION_MODE_FULLCPU<span class="o">)</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nv">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>SDL_PASS<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;\n Configurationn verified&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Compute the signature:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SDL_MCRC_dataConfig_t<span class="w"> </span>mcrcData<span class="p">;</span>
SDL_MCRC_Signature_t<span class="w">  </span>sectSignVal<span class="p">;</span>

mcrcData.pMCRCData<span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="o">(</span>uint32_t<span class="w"> </span>*<span class="o">)</span>testParams<span class="o">[</span>testCase<span class="o">]</span>.sourceMemory<span class="p">;</span>
mcrcData.size<span class="w">           </span><span class="o">=</span><span class="w"> </span>testParams<span class="o">[</span>testCase<span class="o">]</span>.dataSize<span class="p">;</span>
mcrcData.dataBitSize<span class="w">    </span><span class="o">=</span><span class="w"> </span>SDL_MCRC_DATA_32_BIT<span class="p">;</span>

/*<span class="w"> </span>Pass<span class="w"> </span>the<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span>MCRC<span class="w"> </span>and<span class="w"> </span>get<span class="w"> </span>the<span class="w"> </span>signature<span class="w"> </span>*/
<span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_MCRC_computeSignCPUmode<span class="o">(</span>MCRC_MCU_NAVSS,<span class="w"> </span>SDL_MCRC_CHANNEL_1,<span class="w"> </span><span class="p">&amp;</span>mcrcData,<span class="w"> </span><span class="p">&amp;</span>sectSignVal<span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>Check the calculated signature:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/*
<span class="w"> </span>*<span class="w"> </span>Check<span class="w"> </span><span class="k">if</span><span class="w"> </span>the<span class="w"> </span>generated<span class="w"> </span>MCRC<span class="w"> </span>signature<span class="w"> </span>value
<span class="w"> </span>*<span class="w"> </span>matches<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>reference<span class="w"> </span>signaure<span class="w"> </span>vaule
<span class="w"> </span>*/
<span class="k">if</span><span class="w"> </span><span class="o">((</span>sectSignVal.regH<span class="w"> </span><span class="o">==</span><span class="w"> </span>testParams<span class="o">[</span>testCase<span class="o">]</span>.mcrcSignHigh<span class="o">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="o">(</span>sectSignVal.regL<span class="w"> </span><span class="o">==</span><span class="w"> </span>testParams<span class="o">[</span>testCase<span class="o">]</span>.mcrcSignLow<span class="o">))</span>
<span class="o">{</span>
<span class="w">    </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_PASS<span class="p">;</span>
<span class="o">}</span>
<span class="k">else</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_EFAIL<span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="examples">
<h2><span class="section-number">4.11.3. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Test apps that are meant for verifying the functionality of the module are also provided.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test App Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Location</p></th>
<th class="head"><p>Build Command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mcrc_test_app</p></td>
<td><ul class="simple">
<li><p>Configures the MCRC instance and channel</p></li>
<li><p>Calculates the signature in one of the mode</p></li>
<li><p>Checks the resulting signature</p></li>
</ul>
</td>
<td><p>[sdl_install_dir]/test/mcrc/mcrcFuncTest</p></td>
<td><p>make mcrc_test_app PROFILE=release</p></td>
</tr>
</tbody>
</table>
</section>
<section id="api">
<h2><span class="section-number">4.11.4. </span>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="../../../apiguide/j721s2/html/group__SDL__MCRC__API.html">MCRC API Guide</a></p>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="r5fccm.html" class="btn btn-neutral float-right" title="4.12. R5F CCM: CPU Compare Module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dcc.html" class="btn btn-neutral" title="4.10. DCC : Dual Clock Comparator" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2021</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'01_01_00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });
      });
  </script>
   

</body>
</html>