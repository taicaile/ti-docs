

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.12. R5F CCM: CPU Compare Module &mdash; Software Diagnostics Library (SDL) - J721S2 User Guide</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Software Diagnostics Library (SDL) - J721S2 User Guide" href="../index.html"/>
        <link rel="up" title="4. Modules" href="../family_cfg/j721s2/index_modules_j721s2.html"/>
        <link rel="next" title="4.13. OSAL" href="osal.html"/>
        <link rel="prev" title="4.11. MCRC : Cyclic Redundancy Check" href="mcrc.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="../_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index_j721s2.html" class="icon icon-home"> Software Diagnostics Library (SDL) - J721S2 User Guide
          

          
          </a>

          
            
            
              <div class="version">
                01_01_00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_release_notes_j721s2.html">2. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">3. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../family_cfg/j721s2/index_modules_j721s2.html">4. Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="esm.html">4.1. ESM : Error Signalling Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecc.html">4.2. ECC : Error Correcting Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbist.html">4.3. PBIST : Memory Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="lbist.html">4.4. LBIST : Logic Built-In Self-Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtm.html">4.5. VTM : Voltage and Thermal Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="rti.html">4.6. RTI : RTI/WWDT Windowed Watchdog Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="pok.html">4.7. POK: Power OK</a></li>
<li class="toctree-l2"><a class="reference internal" href="tog.html">4.8. TOG : Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtog.html">4.9. MTOG : Master Time-Out Gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcc.html">4.10. DCC : Dual Clock Comparator</a></li>
<li class="toctree-l2"><a class="reference internal" href="mcrc.html">4.11. MCRC : Cyclic Redundancy Check</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.12. R5F CCM: CPU Compare Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">4.12.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">4.12.2. Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">4.12.3. Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">4.12.4. API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="osal.html">4.13. OSAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="r5.html">4.14. R5 Core Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rom_checksum.html">4.15. ROM_CHECKSUM: ROM Checksum Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_examples_j721s2.html">5. Safety Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diagnostic_mappings.html">6. Diagnostic Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../family_cfg/j721s2/index_application_notes_j721s2.html">7. Developer Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_j721s2.html">Software Diagnostics Library (SDL) - J721S2 User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_j721s2.html">Docs</a> &raquo;</li>
      
          <li><a href="../family_cfg/j721s2/index_modules_j721s2.html"><span class="section-number">4. </span>Modules</a> &raquo;</li>
      
    <li><span class="section-number">4.12. </span>R5F CCM: CPU Compare Module</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="r5f-ccm-cpu-compare-module">
<h1><span class="section-number">4.12. </span>R5F CCM: CPU Compare Module<a class="headerlink" href="#r5f-ccm-cpu-compare-module" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2><span class="section-number">4.12.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Compute Compare Module (CCM) is the R5F sub-system’s implementation for the lockstep error detection logic. The R5F sub-system, when bootstrapped to lockstep mode, has a logic that compares the outputs of the two cores and asserts an interrupt whenever an error is detected. There is also a logic to test the comparison logic.</p>
<p>The CCM performs these main functions:</p>
<ul class="simple">
<li><p>CPU output compare</p></li>
<li><p>Inactivity monitoring</p></li>
<li><p>VIM compare</p></li>
</ul>
<p>The CPU output compare function compares the core compare bus outputs of the two R5F cores. The Inactivity monitoring function detects any transaction initiated by the diagnostic R5F core (the diagnostic core should not initiate any transaction in lockstep mode). The VIM compare function compares the VIM bus outputs of the cores.</p>
<p>For each of the functions, there are four operating modes:</p>
<ul class="simple">
<li><p>Compare active block (normal operation, outputs are compared)</p></li>
<li><p>Self test (block is checked for faults and an error is generated if fault is detected)</p></li>
<li><p>Error forcing (error is forced to be generated from module)</p></li>
<li><p>Self test error forcing (self-test error signal is forced to be generated)</p></li>
</ul>
<p>The CCM module provides APIs to:</p>
<ul class="simple">
<li><p>Initialize the R5F CCM for the operating modes and verify the config</p></li>
<li><p>Perform Self-test of the supported operating modes (normal and error forcing)</p></li>
<li><p>Inject an error</p></li>
<li><p>Read back the static config registers</p></li>
<li><p>Clear errors that have occurred due to error injection or actual fault</p></li>
</ul>
<p>Errors detected by the CCM module during operation in Compare active block mode are reported via ESM error (application will receive via ESM application callback). ESM error generated as part of the self-test are not reported to the application.</p>
<p>Note that currently only the MCU R5F instance is supported by this module.</p>
</section>
<section id="example-usage">
<h2><span class="section-number">4.12.2. </span>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>The following shows an example of SDL R5F CCM API usage by the application.</p>
<p>Initialize the R5F CCM instance</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">retVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_CCM_init<span class="o">(</span>SDL_CCM_MCU_R5F0<span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>Verify the configuration:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">retVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_CCM_verifyConfig<span class="o">(</span>SDL_CCM_MCU_R5F0<span class="o">)</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nv">retVal</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>SDL_PASS<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;\n Configurationn verified&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Perform a self-test:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">retVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_CCM_selfTest<span class="o">(</span>SDL_CCM_MCU_R5F0,
<span class="w">                          </span>SDL_CCM_MONITOR_TYPE_OUTPUT_COMPARE_BLOCK,
<span class="w">                          </span>SDL_CCM_SELFTEST_TYPE_NORMAL,<span class="w"> </span>0U,
<span class="w">                          </span><span class="m">10000000</span><span class="o">)</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="o">(</span>retVal<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>SDL_PASS<span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;\n CCM self test failed&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;\n CCM Self Test complete&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Inject an error:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">retVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SDL_CCM_injectError<span class="o">(</span>SDL_CCM_MCU_R5F0,<span class="w"> </span>SDL_CCM_MONITOR_TYPE_OUTPUT_COMPARE_BLOCK<span class="o">)</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="o">(</span>retVal<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>SDL_PASS<span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>UART_printf<span class="o">(</span><span class="s2">&quot;\n CCM inject failed&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>

/*<span class="w"> </span>Wait<span class="w"> </span><span class="k">for</span><span class="w"> </span>error<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>returned<span class="w"> </span>via<span class="w"> </span>ESM<span class="w"> </span>application<span class="w"> </span>callback<span class="w"> </span>*/
</pre></div>
</div>
</div></blockquote>
</section>
<section id="examples">
<h2><span class="section-number">4.12.3. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Test apps that are meant for verifying the functionality of the module are also provided.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test App Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Location</p></th>
<th class="head"><p>Build Command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sdl_ccm_test_app</p></td>
<td><ul class="simple">
<li><p>Initializes the CCM and sets to active mode</p></li>
<li><p>Performs self-tests</p></li>
<li><p>Performs error injection and checks for ESM event</p></li>
</ul>
</td>
<td><p>[sdl_install_dir]/test/ccm/ccm_func_test</p></td>
<td><p>make sdl_ccm_test_app PROFILE=release</p></td>
</tr>
</tbody>
</table>
</section>
<section id="api">
<h2><span class="section-number">4.12.4. </span>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="../../../apiguide/j721s2/html/group__SDL__CCM__API.html">R5F CCM API Guide</a></p>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="osal.html" class="btn btn-neutral float-right" title="4.13. OSAL" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mcrc.html" class="btn btn-neutral" title="4.11. MCRC : Cyclic Redundancy Check" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2021</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'01_01_00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });
      });
  </script>
   

</body>
</html>